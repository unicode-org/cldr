<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en-us">
<link rel="stylesheet" href="http://www.unicode.org/reports/reports.css" type="text/css">
<title>UTS #35: Unicode LDML: Collation</title>
<style type="text/css">
<!--
.dtd         { font-family: monospace; font-size:90%; background-color:#CCCCFF; border-style: dotted; border-width: 1px;}
.xmlExample  { font-family: monospace; font-size: 80% }
.blockedInherited { font-style: italic; font-weight: bold; border-style: dashed; border-width: 1px; 
               background-color: #FF0000 }
.inherited   { font-weight: bold; border-style: dashed; border-width: 1px; background-color: 
               #00FF00 }
.element { font-weight: bold; color: red; }
.attribute { font-weight: bold; color: maroon; }
.attributeValue { font-weight: bold; color: blue; }

li, p           { margin-top: 0.5em; margin-bottom: 0.5em }
h2, h3, h4, table           { margin-top: 1.5em; margin-bottom: 0.5em; }
-->
</style>
</head>

<body>

<table class="header" width="100%">
	<tr>
		<td class="icon"><a href="http://unicode.org">
		<img alt="[Unicode]" src="http://unicode.org/webscripts/logo60s2.gif" width="34" height="33" style="vertical-align: middle; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px; border-top-width: 0px;"></a>&nbsp;
		<a class="bar" href="http://www.unicode.org/reports/">Technical Reports</a></td>
	</tr>
	<tr>
		<td class="gray">&nbsp;</td>
	</tr>
</table>
<div class="body">
	<h2 style="text-align: center">Unicode Technical Standard #35</h2>
	<h1>Unicode Locale Data Markup Language (LDML)<br>Part 5: Collation</h1>
	<table border="1" cellpadding="2" cellspacing="0" class="wide">
		<tr>
			<td>Version</td>
			<td><span class="changed">24</span></td>
		</tr>
		<tr>
			<td>Editors</td>
			<td><a href="https://plus.google.com/114199149796022210033?rel=author">Mark Davis</a>
			(<a href="mailto:markdavis@google.com">markdavis@google.com</a>),
			<a href="https://plus.google.com/117587389715494866571?rel=author" class="changed">Markus Scherer</a>,
			and other CLDR committee members</td>
		</tr>
		<tr>
			<td>Date</td>
			<td>2013-<span class="changed">09-03</span></td>
		</tr>
		<tr>
			<td>This Version</td>
			<td>
			<a class="changed" href="http://www.unicode.org/reports/tr35/tr35-32/tr35.html">http://www.unicode.org/reports/tr35/tr35-32/tr35.html</a></td>
		</tr>
		<tr>
			<td>Previous Version</td>
			<td>
			<a href="http://www.unicode.org/reports/tr35/tr35-31/tr35.html" class="changed">http://www.unicode.org/reports/tr35/tr35-31/tr35.html</a></td>
		</tr>
		<tr>
			<td>Latest Version</td>
			<td><a href="http://www.unicode.org/reports/tr35/">http://www.unicode.org/reports/tr35/</a></td>
		</tr>
		<tr>
			<td>Corrigenda</td>
			<td><a href="http://unicode.org/cldr/corrigenda.html">http://unicode.org/cldr/corrigenda.html</a> </td>
		</tr>
		<tr>
			<td>Latest Proposed Update</td>
			<td><a href="http://www.unicode.org/reports/tr35/proposed.html">http://www.unicode.org/reports/tr35/proposed.html</a></td>
		</tr>
		<tr>
			<td>Namespace</td>
			<td><a href="http://cldr.unicode.org/">http://cldr.unicode.org/</a></td>
		</tr>
		<tr>
			<td>DTDs</td>
			<td><a class="changed" href="http://unicode.org/cldr/dtd/24/">http://unicode.org/cldr/dtd/24/</a></td>
		</tr>
		<tr>
			<td>Revision</td>
			<td><a class="changed" href="#Modifications">32</a></td>
		</tr>
	</table>
	<h3><i>Summary</i></h3>
	<p>This document describes parts of an XML format (<i>vocabulary</i>)
	for the exchange of structured locale data. This format is used in the 
	<a href="http://unicode.org/cldr/">Unicode Common Locale Data Repository</a>.</p>

	<p>This is a partial document, describing only those parts of the LDML
	that are relevant for collation (sorting, searching &amp; grouping).
	For the other parts of the LDML see the <a href="tr35.html">main LDML document</a> and the links above.</p>
	
	<h3><i>Status</i></h3>

	   <!-- NOT YET APPROVED -->
	  <p><i class="changed">This is a<b><font color="#ff3333"> draft </font></b>document which 
      may be updated, replaced, or superseded by other documents at any time. 
      Publication does not imply endorsement by the Unicode Consortium. This is 
      not a stable document; it is inappropriate to cite this document as other 
      than a work in progress.</i></p>
      <!-- END NOT YET APPROVED -->
	  <!-- APPROVED 
      <p><i>This document has been reviewed by Unicode members and other 
	  interested parties, and has been approved for publication by the Unicode 
	  Consortium. This is a stable document and may be used as reference 
	  material or cited as a normative reference by other specifications.</i></p>
       END APPROVED -->

	<blockquote>
		<p><i><b>A Unicode Technical Standard (UTS)</b> is an independent specification. Conformance to the Unicode Standard does not imply conformance to any UTS.</i></p>
	</blockquote>
	<p><i>Please submit corrigenda and other comments with the CLDR bug reporting form [<a href="tr35.html#Bugs">Bugs</a>]. Related information that is useful in understanding 
	this document is found in the <a href="tr35.html#References">References</a>. For the latest version of the Unicode Standard see [<a href="tr35.html#Unicode">Unicode</a>]. For 
	a list of current Unicode Technical Reports see [<a href="tr35.html#Reports">Reports</a>]. For more information about versions of the Unicode Standard, see [<a href="tr35.html#Versions">Versions</a>]. 
	</i></p>

<h2><a name="Contents" href="#Contents">Contents of Part 5, Collation</a></h2>
	<ul class="toc">
		<li>1 <a href="#CLDR_Collation">CLDR Collation</a>
                  <ul class="toc">
                    <li class="changed">1.1 <a href="#CLDR_Collation_Algorithm">CLDR Collation Algorithm</a></li>
                  </ul>
        </li>
		<li>2 <a href="#Root_Collation">Root Collation</a>
                  <ul class="toc">
                    <li>2.1 <a href="#Root_Data_Files">Root Collation Data Files</a></li>
                    <li>2.2 <a href="#Root_Data_File_Formats">Root Collation Data File Formats</a></li>
                  </ul>
		</li>
		<li>3 <a href="#Collation_Tailorings">Collation Tailorings</a>
                  <ul class="toc">
                    <li>3.1 <a href="#Collation_Version">Version</a></li>
                    <li>3.2 <a href="#Collation_Element">Collation Element</a></li>
                    <li>3.3 <a href="#Setting_Options">Setting Options</a></li>
                    <li>3.4 <a href="#Rules">Collation Rule Syntax</a></li>
                    <li>3.5 <a href="#Orderings">Orderings</a></li>
                    <li>3.6 <a href="#Contractions">Contractions</a></li>
                    <li>3.7 <a href="#Expansions">Expansions</a></li>
                    <li>3.8 <a href="#Context_Before">Context Before</a></li>
                    <li>3.9 <a href="#Placing_Characters_Before_Others">Placing Characters Before Others</a></li>
                    <li>3.10 <a href="#Logical_Reset_Positions">Logical Reset Positions</a></li>
                    <li>3.11 <a href="#Special_Purpose_Commands">Special-Purpose Commands</a></li>
                    <li>3.12 <a href="#Script_Reordering">Collation Reordering</a></li>
                    <li>3.13 <a href="#Case_Parameters">Case Parameters</a></li>
                    <li>3.14 <a href="#Visibility">Visibility</a></li>
                    <li>3.15 <a href="#Collation_Indexes">Collation Indexes</a></li>
                  </ul>
                </li>
	</ul>
<h2><a name="CLDR_Collation" href="#CLDR_Collation">1 CLDR Collation</a></h2>
  <p>Collation is the general term for the process and function of
  determining the sorting order of strings of characters,
  for example for lists of strings presented to users,
  or in databases for sorting and selecting records.</p>

  <p>Collation varies by language, by application (some languages use special phonebook sorting),
  and other criteria (for example, phonetic vs. visual).</p>

  <p>CLDR provides collation data for many languages and styles.
  The data supports not only sorting but also language-sensitive searching
  and grouping under index headers.
  All CLDR collations are based on the [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>] default order,
  with common modifications applied in the CLDR root collation,
  and further tailored for language and style as needed.</p>

<h3 class="changed"><a name="CLDR_Collation_Algorithm" href="#CLDR_Collation_Algorithm">1.1 CLDR Collation Algorithm</a></h3>
<p class="reviewnote">This whole section is new for CLDR 24.</p>
<p>The CLDR collation algorithm is an extension of the <a href="http://www.unicode.org/reports/tr10/#Main_Algorithm">Unicode Collation Algorithm</a>.</p>

<h4><a name="Algorithm_FFFE" href="#Algorithm_FFFE">U+FFFE</a></h4>

<p>U+FFFE maps to a CE with special minimal weights on all levels,
including case, quaternary and identical levels &mdash; which may require special code for those levels.
Its primary weight is not "variable": U+FFFE must not become ignorable in alternate handling.
This allows for <a href="http://www.unicode.org/reports/tr10/#Merging_Sort_Keys">Merging Sort Keys</a>
within code point space.
For example, when sorting names in a database,
a sortable string can be formed with <em>last_name</em> + '\uFFFE' + <em>first_name</em>.
These strings would sort properly, without ever comparing the last part of a last name
with the first part of another first name.</p>

<p>For backwards secondary level sorting,
text <i>segments</i> separated by U+FFFE are processed in forward segment order,
and <i>within</i> each segment the secondary weights are compared backwards.
This is so that such combined strings are processed consistently with concatenating their sort keys.</p>

<h4><a name="Context_Sensitive_Mappings" href="#Context_Sensitive_Mappings">Context-Sensitive Mappings</a></h4>

<p>Contraction matching, as in the UCA, starts from the first character of the contraction string.
It slows down processing of that first character even when none of its contractions matches.
In some cases, it is preferrable to change such contractions to mappings with a prefix (context before a character),
so that complex processing is done only when the less-frequently occurring trailing character is encountered.</p>

<p>For example, the DUCET contains contractions for several variants of L¬∑ (L followed by middle dot).
Collating ASCII text is slowed down by contraction matching starting with L/l.
In the CLDR root collation, these contractions are replaced by prefix mappings (L|¬∑)
which are triggered only when the middle dot is encountered.
CLDR also uses prefix rules in the Japanese tailoring,
for processing of Hiragana/Katakana length and iteration marks.</p>

<p>The mapping is conditional on the prefix match but does not change the mappings for the preceding text.
As a result, a contraction mapping for "px" can be replaced by a prefix rule "p|x" only if
px maps to the collation elements for p followed by the collation elements for "x if after p".
In the DUCET, L¬∑ maps to CE(L) followed by a special secondary CE (which differs from CE(¬∑) when ¬∑ is not preceded by L).
In the CLDR root collation, L has no context-sensitive mappings,
but ¬∑ maps to that special secondary CE if preceded by L.</p>

<p>A prefix mapping for p|x behaves mostly like the contraction px,
except when there is a contraction that overlaps with the prefix,
for example one for "op".
A contraction matches only new text (and consumes it),
while a prefix matches only already-consumed text.</p>
<ul>
  <li>With mappings for "op" and "px", only the first contraction matches in text "opx".
    (It consumes the "op" characters, and there is no context-sensitive mapping for x.)</li>
  <li>With mappings for "op" and "p|x", both the contraction and the prefix rule match in text "opx".
    (The prefix always matches already-consumed characters, regardless of whether they mapped as part of contractions.)</li>
</ul>

<p>Note: Matching of discontiguous contractions should be implemented without rewriting the text
(unlike in the [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>] algorithm specification),
so that prefix matching is predictable.
(It should also help with contraction matching performance.)
An implementation that does rewrite the text, as in the UCA, will get different results
for some (unusual) combinations of contractions, prefix rules, and input text.</p>

<p>Prefix matching uses a simple longest-match algorithm (op|c wins over p|c).
It is recommended that prefix rules be limited to mappings where both the prefix string and the mapped string
begin with an NFC boundary (that is, with a normalization starter that does not combine backwards).
(In op|ch both o and c should be starters (ccc=0) and NFC_QC=Yes.)
Otherwise, prefix matching would be affected by canonical reordering and discontiguous matching,
like contractions.
Prefix matching is thus always contiguous.</p>

<p>A character can have mappings with both prefixes (context before) and contraction suffixes.
Prefixes are matched first. This is to keep them reasonably implementable:
When there is a mapping with both a prefix and a contraction suffix (like in Japanese: „Åê|„Çû),
then the matching needs to go in both directions.
The contraction might involve discontiguous matching,
which needs complex text iteration and handling of skipped combining marks,
and will consume the matching suffix.
Prefix matching should be first because, regardless of whether there is a match,
the implementation will always return to the original text index (right after the prefix)
from where it will start to look at all of the contractions for that prefix.</p>

<p>If there is a mapping for p|c where c is a single character, and text "...pc...",
then the p|c mapping should "win" over any contractions that start with c but do not have the prefix.</p>

<p>Consider the following mappings.</p>
<ol>
  <li>p ‚Üí CE(p)</li>
  <li>h ‚Üí CE(h)</li>
  <li>c ‚Üí CE(c)</li>
  <li>ch ‚Üí CE(d)</li>
  <li>p|c ‚Üí CE(u)</li>
  <li>p|ci ‚Üí CE(v)</li>
</ol>

<p>With these, text collates like this:</p>
<ul>
  <li>pc ‚Üí CE(p)CE(u)</li>
  <li>pci ‚Üí CE(p)CE(v)</li>
  <li>pch ‚Üí CE(p)CE(u)CE(h)</li>
</ul>

<p>However, if the mapping p|c ‚Üí CE(u) is missing, then text "pch" maps to CE(p)CE(d).</p>


<h2><a name="Root_Collation" href="#Root_Collation">2 Root Collation</a></h2>
  <p>The CLDR root collation order
  is based on the <span class="removed">UCA default table</span> <span class="changed"><a href="http://www.unicode.org/reports/tr10/#Default_Unicode_Collation_Element_Table">Default Unicode Collation Element Table (DUCET)</a></span> defined in
  <em>UTS #10: Unicode Collation Algorithm</em> [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>].
  It is used by all other locales by default, or as the base for their tailorings.
  (For a chart view of the UCA, see Collation Chart [<a href="tr35.html#UCAChart">UCAChart</a>].)</p>
  <p>Starting with CLDR 1.9,
  CLDR uses modified tables for the root collation order.
  The root locale ordering is tailored in the following ways:</p>

  <h3><a name="grouping_classes_of_characters" href="#grouping_classes_of_characters">Grouping classes of characters</a></h3>
  <p>As of Version 6.1.0, the DUCET puts characters into the following ordering:</p>
  <ul>
    <li>First &quot;common characters&quot;: whitespace, punctuation,
    general symbols, some numbers, currency symbols, and other numbers.</li>
    <li>Then &quot;script characters&quot;: Latin, Greek, and the rest of the scripts.</li>
  </ul>
  <p>(There are a few exceptions to this general ordering.)</p>
  <p>The CLDR root locale modifies the DUCET tailoring by ordering the common characters more strictly by category:</p>
  <ul>
    <li>whitespace, punctuation, general symbols, currency symbols, and numbers.</li>
  </ul>
  <p>What the regrouping allows is for users to parametrically reorder the groups.
  For example, users can reorder numbers after all scripts, or reorder Greek before Latin.</p>
  <p>The relative order within each of these groups still matches the DUCET.
  Symbols, punctuation, and numbers that are grouped with a particular script stay with that script.
  The differences between CLDR and the DUCET order are:</p>
  <ol>
    <li>CLDR groups the numbers together after currency symbols,
    instead of splitting them with some before and some after. 
    Thus the following are put <em>after</em> currencies and just before all the other numbers.
    <blockquote>
      <p>U+09F4 ( ‡ß¥ ) [No] BENGALI CURRENCY NUMERATOR ONE<br>
        ...<br>
        U+1D371 ( ùç± ) [No] COUNTING ROD TENS DIGIT NINE</p>
    </blockquote>
    </li>
    <li>CLDR handles a few other characters differently
      <ol>
        <li>U+10A7F ( ê©ø ) [Po] OLD SOUTH ARABIAN NUMERIC INDICATOR
        is put with punctuation, not symbols</li>
        <li>U+20A8 ( ‚Ç® ) [Sc] RUPEE SIGN and U+FDFC ( Ô∑º ) [Sc] RIAL SIGN
        are put with currency signs, not with R and REH.</li>
      </ol>
    </li>
  </ol>

  <h3><a name="non_variable_symbols" href="#non_variable_symbols">Non-variable symbols</a></h3>
  <p>There are multiple <a href="http://www.unicode.org/reports/tr10/#Variable_Weighting">Variable-Weighting</a> options
  in the UCA for symbols and punctuation, including <em>non-ignorable</em> and <em>shifted</em>. 
  With the <em>shifted</em> option, almost all symbols and punctuation are ignored‚Äîexcept at a fourth level. 
  The CLDR root locale ordering is modified so that symbols are not affected by the <em>shifted</em> option.
  That is, by default, symbols are not ‚Äúvariable‚Äù in CLDR.
  So <em>shifted</em> only causes whitespace and punctuation to be ignored, but not symbols (like ‚ô•). 
  The DUCET behavior can be specified with a locale ID using the &quot;vt&quot; keyword, to set the Variable section to 
  include all of the symbols below it, or be set parametrically where implementations allow access.</p>
  <p>See also:</p>
  <ul>
    <li><i>Section 3.3, <a href="#Setting_Options">Setting Options</a></i></li>
    <li><a href="http://www.unicode.org/charts/collation/">http://www.unicode.org/charts/collation/</a></li>
  </ul>

  <h3><a name="tibetan_contractions" href="#tibetan_contractions">Additional contractions for Tibetan</a></h3>
  <p>Ten contractions are added for Tibetan:
  Two to fulfill <a href="http://www.unicode.org/reports/tr10/#WF5">well-formedness condition 5</a>,
  and eight more to preserve the default order for Tibetan.
  For details see <i>UTS #10, Section 3.6.4,
  <a href="http://www.unicode.org/reports/tr10/#Well_Formed_DUCET">Well-Formedness of the DUCET</a></i>.</p>

  <h3><a name="tailored_noncharacter_weights" href="#tailored_noncharacter_weights">Tailored noncharacter weights</a></h3>
  <p>U+FFFE and U+FFFF have special tailorings:</p>
  <blockquote>
    <p><strong>U+FFFF: </strong>This code point is tailored to have a
    primary weight higher than all other characters.
    This allows the reliable specification of a range,
    such as &ldquo;Sch&rdquo; ‚â§ X ‚â§ &ldquo;Sch\uFFFF&rdquo;,
    to include all strings starting with &quot;sch&quot; or equivalent.</p>
    <p><strong>U+FFFE: </strong>This code point produces a CE with special minimal weights on all levels.
    <span class="removed">regardless of alternate handling.
    This allows for <a href="http://www.unicode.org/reports/tr10/#Merging_Sort_Keys">Merging Sort Keys</a>
    within code point space.
    For example, when sorting names in a database,
    a sortable string can be formed with <em>last_name</em> + '\uFFFE' + <em>first_name</em>.
    These strings would sort properly, without ever comparing the last part of a last name
    with the first part of another first name.<br></span>
    <span class="changed">For details see the <i><a href="#Algorithm_FFFE">CLDR Collation Algorithm</a></i> above.</span></p>
  </blockquote>
  <p class="changed">UCA (beginning with version 6.3) also maps <strong>U+FFFD</strong>
  to a special collation element with a very high primary weight,
  so that it is reliably non-<a href="http://www.unicode.org/reports/tr10/#Variable_Weighting">variable</a>,
  for use with <a href="http://www.unicode.org/reports/tr10/#Handling_Illformed">ill-formed code unit sequences</a>.</p>
  <p>In CLDR, so as to maintain the special collation elements,
  <strong>U+FFF<span class="changed">D</span>..U+FFFF</strong> are not further tailorable, and nothing can tailor to them.
  That is, neither can occur in a collation rule. For example, the following rules are illegal:</p>
  <p><code>&amp;\uFFFF &lt; x</code></p>
  <p><code>&amp;x &lt;\uFFFF</code><br>
  </p>

<p class="note"><b>Note:</b></p>
  <ul>
    <li class="note">Java uses an early version of <span class="removed">the basic</span> <span class="changed">this</span> collation syntax, but has not been updated recently.
    It does not support any of the <span class="removed">basic</span> syntax marked with [...],
    and its default table is not the DUCET <span class="changed">nor the CLDR root collation</span>.</li>
  </ul>

<h3><a name="Root_Data_Files" href="#Root_Data_Files">2.1 Root Collation Data Files</a></h3>
  <p>The CLDR root collation data files are in the CLDR repository and release,
  under the path <a href="http://unicode.org/repos/cldr/trunk/common/uca/">common/uca/</a>.</p>

  <p class="changed">For most data files there are <strong>_SHORT</strong> versions available.
  They contain the same data but only minimal comments, to reduce the file sizes.</p>

  <p>Comments with DUCET-style weights in files other than allkeys_CLDR.txt <span class="changed">and allkeys_DUCET.txt</span>
  use the weights defined in allkeys_CLDR.txt.</p>
  <ul>
    <li><strong>allkeys_CLDR</strong> -
    A file that provides a remapping of UCA DUCET weights for use with CLDR.</li>
    <li class="changed"><strong>allkeys_DUCET</strong> -
    The same as DUCET allkeys.txt, but in alternate=non-ignorable sort order,
    for easier comparison with allkeys_CLDR.txt.</li>
    <li><strong>FractionalUCA</strong> -
      A file that provides a remapping of UCA DUCET weights for use with CLDR.
      The weight values are <span class="removed">also modified to provide variable-width weights for compression.</span>
      <span class="changed">modified:</span>
      <ul class="changed">
        <li>The weights have variable length, with 1..4 bytes each.</li>
        <li>There are tailoring gaps between adjacent weights,
          so that a number of characters can be tailored to sort between any two root collation elements.</li>
        <li>There are collation elements with primary weights at the boundaries between reordering groups and Unicode scripts,
          so that tailoring around the first or last primary of a group/script results in new collation elements
          that sort and reorder together with that group or script.</li>
        <li>Also, there is data that defines the primary weight ranges for parametric group and script reordering.</li>
      </ul>
      <span class="changed">An implementation may modify the weights further to fit the needs of its data structures.</span>
    </li>
    <li><strong>UCA_Rules</strong> -
    <span class="removed">A file that provides the information in FractionalUCA as a set of comparison rules,
    for use with CLDR and other environments.
    These rules provide the relative values for different characters without being tied to particular weights.
    There may be some minor differences in the resulting ordering compared to the allkeys_CLDR. 
    For example, "&amp;D &lt;&lt;&lt; «≤ / z" will create a sequence of two CEs for «≤.
    The tertiary difference (for the syntax &lt;&lt;&lt;) is produced
    by incrementing the tertiary weight on the first CE.
    This may not correspond to how tertiary differences are distributed
    across the two CEs by the DUCET.</span>
    <br><span class="changed">A file that specifies the root collation order
    in the form of <a href="#Collation_Tailorings">tailoring rules</a>.
    This is only an approximation of the FractionalUCA data,
    since the rule syntax cannot express every detail of the collation elements.
    For example, in the DUCET and in FractionalUCA, tertiary differences are usually expressed
    with special tertiary weights on all collation elements of an expansion,
    while a typical from-rules builder will modify the tertiary weight of only one of the collation elements.</span></li>
    <li><strong>CollationTest_CLDR</strong> - The CLDR versions of the CollationTest files,
      which use the tailorings for CLDR.
      For information on the format, see
      <a href="http://www.unicode.org/Public/UCA/latest/CollationTest.html">CollationTest.html</a>
      in the <a href="http://www.unicode.org/reports/tr10/#Data10">UCA data directory</a>.
      <ul>
        <li>CollationTest_CLDR_NON_IGNORABLE.txt</li>
        <li>CollationTest_CLDR_SHIFTED.txt</li>
      </ul>
    </li>
  </ul>

<h3><a name="Root_Data_File_Formats" href="#Root_Data_File_Formats">2.2 Root Collation Data File Formats</a></h3>

  <p>The file formats may change between versions of CLDR.
  The formats for CLDR 23 and beyond are as follows.
  As usual, text after a # is a comment.</p>

<h4>allkeys_CLDR.txt</h4>
  <p>This file defines CLDR‚Äôs tailoring of the DUCET,
  as described in <i>Section 2, <a href="#Root_Collation">Root Collation</a></i>.</p>
  <p>The format is similar to that of <a href="http://www.unicode.org/reports/tr10/#File_Format">allkeys.txt</a>,
  although there may be some differences in whitespace.</p>

<h4>FractionalUCA.txt</h4>
  <p>The format is illustrated by the following sample lines, with commentary  afterwards.</p>
  <pre>[UCA version = 6.0.0]</pre>
  <blockquote>
    <p>Provides the version number of the UCA table.</p>
  </blockquote>

  <pre class="changed">[Unified_Ideograph 4E00..9FCC FA0E..FA0F FA11 FA13..FA14 FA1F FA21 FA23..FA24 FA27..FA29 3400..4DB5 20000..2A6D6 2A700..2B734 2B740..2B81D]</pre>
  <blockquote>
    <p class="changed">Lists the ranges of Unified_Ideograph characters in collation order.
    They map to collation elements with
    <a href="http://www.unicode.org/reports/tr10/#Implicit_Weights">implicit (constructed) primary weights</a>.</p>
  </blockquote>

  <pre>0000; [,,]     # Zyyy Cc       [0000.0000.0000]        * &lt;NULL&gt;</pre>
  <blockquote>
    <p>Provides a weight line. The first element (before the &quot;;&quot;) is a hex codepoint sequence. 
    The second field is a sequence of collation elements.
    Each collation element has 3 parts separated by commas: 
    the primary weight, secondary weight, and tertiary weight.
    The tertiary weight actually consists of two components: 
    the top two bits (0xC0) are used for the <em>case level</em>,
    and should be masked off where a case level is not used.</p>
    <p>A weight is either empty (meaning a zero or ignorable weight)
    or is a sequence of one or more bytes.
    The bytes are interpreted as a &quot;fraction&quot;,
    meaning that the ordering is 04 &lt; 05 05 &lt; 06.
    The weights are constructed so that no weight is an initial subsequence of another:
    that is, having both the weights 05 and 05 05 is illegal.
    The above line consists of all ignorable weights.</p>
    <p>The vertical bar (‚Äú|‚Äù) character is used to indicate context, as in:</p>
  </blockquote>
  <pre>006C | 00B7; [, DB A9, 05]</pre>
  <blockquote> This example indicates  that if U+00B7 appears immediately after U+006C,
  it is given the corresponding collation element instead.
  This syntax is <span class="changed">roughly</span> equivalent to the following contraction, but is more efficient.
  <span class="changed">For details see the specification of <i><a href="#Context_Sensitive_Mappings">Context-Sensitive Mappings</a></i> above.</span></blockquote>
  <pre>006C 00B7; <em>CE(006C)</em> [, DB A9, 05]</pre>
  <blockquote>
    <p>Single-byte primary weights are given to particularly frequent characters,
    such as space, digits, and a-z.
    <span class="removed">Most</span> <span class="changed">More frequent</span> characters are given two-byte weights,
    while relatively infrequent characters are given three-byte weights.
    For example:</p>
  </blockquote>
  <pre>...
0009; [03 05, 05, 05] # Zyyy Cc       [0100.0020.0002]        * &lt;CHARACTER TABULATION&gt;
...
1B60; [06 14 0C, 05, 05]    # Bali Po       [0111.0020.0002]        * BALINESE PAMENENG
...
0031; [14, 05, 05]    # Zyyy Nd       [149B.0020.0002]        * DIGIT ONE</pre>
  <blockquote>
    <p>The assignment of 2 vs 3 bytes does not reflect importance, or exact frequency.</p>
  </blockquote>
  <pre># SPECIAL MAX/MIN COLLATION ELEMENTS
FFFE; [02, 02, 02]     # Special LOWEST primary, for merge/interleaving
FFFF; [EF FE, 05, 05]  # Special HIGHEST primary, for ranges</pre>
  <blockquote>
    <p>The two tailored noncharacters have their own weights.</p>
  </blockquote>

  <pre class="changed">
F967; [U+4E0D]  # Hani Lo       [FB40.0020.0002][CE0D.0000.0000]        * CJK COMPATIBILITY IDEOGRAPH-F967
2F02; [U+4E36, 10]      # Hani So       [FB40.0020.0004][CE36.0000.0000]        * KANGXI RADICAL DOT
2E80; [U+4E36, 70, 20]  # Hani So       [FB40.0020.0004][CE36.0000.0000][0000.00FC.0004]        * CJK RADICAL REPEAT</pre>
  <blockquote>
    <p class="changed">Some collation elements are specified by reference to other mappings.
    This is particularly useful for Han characters which are given implicit/constructed primary weights;
    the reference to a Unified_Ideograph makes these mappings independent of implementation details.
    This technique may also be used in other mappings
    to show the relationship of character variants.</p>
    <p class="changed">The referenced character must have a mapping listed earlier in the file,
    or the mapping must have been defined via the [Unified_Ideograph] data line.
    The referenced character must map to exactly one collation element.</p>
    <p class="changed"><code>[U+4E0D]</code> copies U+4E0D‚Äôs entire collation element.
    <code>[U+4E36, 10]</code> copies U+4E36‚Äôs primary and secondary weights
    and specifies a different tertiary weight.
    <code>[U+4E36, 70, 20]</code> only copies U+4E36‚Äôs primary weight
    and specifies other secondary and tertiary weights.</p>
  </blockquote>

  <pre class="removed"># SPECIAL FINAL VALUES for Script Reordering
FDD0 0042; [05 FE, 05, 05]     # Special final value for reordering token
FDD0 0043; [0C FE, 05, 05]     # Special final value for reordering token</pre>
  <blockquote>
    <p class="removed">There are special values assigned to code point sequences FDD0+X.
    These sequences are simply used to communicate special values, and can be eliminated.
    For the reordering values, the purpose is to make sure that there is
    a &quot;high&quot; weight at the end of each reordering group.</p>
  </blockquote>

  <pre class="changed">
FDD1 00A0;      [03 02 02, 05, 05]      # SPACE first primary starts reordering group
FDD1 03A9;      [5D 04 02, 05, 05]      # GREEK first primary starts reordering group (compressible)
FDD1 03E2;      [5D 64 02, 05, 05]      # COPTIC first primary</pre>
  <blockquote>
    <p class="changed">These are special mappings with primaries at
    the boundaries of scripts and reordering groups.
    They serve as tailoring boundaries, so that tailoring near the first or last character
    of a script or group places the tailored item into the same group.
    Beginning with CLDR 24, each of these is a contraction of U+FDD1 with the script sample character,
    mapping to the first possible primary weight per script or group.
    They can be enumerated for implementations of <a href="#Collation_Indexes">Collation Indexes</a>.
    (Earlier versions mapped contractions with U+FDD0 to
    the last primary weights of each group but not each script.)</p>
  </blockquote>

  <pre class="changed">
FDD0 0034;      [11, 05, 05]    # lead byte for numeric sorting</pre>
  <blockquote>
    <p class="changed">This mapping specifies the lead byte for numeric sorting.
    It must be different from the lead byte of any other primary weight,
    otherwise numeric sorting would generate ill-formed collation elements.
    Therefore, this mapping itself must be excluded from the set of regular mappings.
    This value can be ignored by implementations that do not support numeric sorting.
    (Other contractions with U+FDD0 can normally be ignored altogether.)</p>
  </blockquote>

  <pre>
# HOMELESS COLLATION ELEMENTS
FDD0 0063; [, 97, 3D]       # [15E4.0020.0004] [1844.0020.0004] [0000.0041.001F]    * U+01C6 LATIN SMALL LETTER DZ WITH CARON
FDD0 0064; [, A7, 09]       # [15D1.0020.0004] [0000.0056.0004]     * U+1DD7 COMBINING LATIN SMALL LETTER C CEDILLA
FDD0 0065; [, B1, 09]       # [1644.0020.0004] [0000.0061.0004]     * U+A7A1 LATIN SMALL LETTER G WITH OBLIQUE STROKE</pre>
  <blockquote>
    <p>The DUCET has some weights that don't correspond directly to a character.
    To allow for implementations to have a <span class="removed">character associated with each weight</span>
    <span class="changed">mapping for each collation element</span>
    (necessary for certain implementations of tailoring),
    this requires the construction of special sequences for those weights.
    <span class="changed">These collation elements can normally be ignored.</span></p>
  </blockquote>

  <p>Next, a number of tables are defined.
  The function of each of the tables is summarized afterwards.</p>

  <pre># VALUES BASED ON UCA
...
[first regular [0D 0A, 05, 05]] # U+0060 GRAVE ACCENT
[last regular [7A FE, 05, 05]] # U+1342E EGYPTIAN HIEROGLYPH AA032
[first implicit [E0 04 06, 05, 05]] # CONSTRUCTED
[last implicit [E4 DF 7E 20, 05, 05]] # CONSTRUCTED
[first trailing [E5, 05, 05]] # CONSTRUCTED
[last trailing [E5, 05, 05]] # CONSTRUCTED
...</pre>
  <blockquote>
    <p>This table summarizes ranges of important groups of characters for implementations.</p>
  </blockquote>
  <pre># Top Byte =&gt; Reordering Tokens
[top_byte     00      TERMINATOR ]    #       [0]     TERMINATOR=1
[top_byte     01      LEVEL-SEPARATOR ]       #       [0]     LEVEL-SEPARATOR=1
[top_byte     02      FIELD-SEPARATOR ]       #       [0]     FIELD-SEPARATOR=1
[top_byte     03      SPACE ] #       [9]     SPACE=1 Cc=6 Zl=1 Zp=1 Zs=1
...</pre>
  <blockquote>
    <p><span class="changed">This table defines the reordering groups, for script reordering.</span>
    The table maps from the first bytes of the fractional weights to a reordering token.
    The format is &quot;[top_byte &quot; byte-value reordering-token &quot;COMPRESS&quot;? &quot;]&quot;.
    The &quot;COMPRESS&quot; value is present when
    there is only one byte in the reordering token,
    and primary-weight compression can be applied.
    Most reordering tokens are script values;
    others are special-purpose values, such as PUNCTUATION.
    <span class="changed">Beginning with CLDR 24, this table precedes the regular mappings,
    so that parsers can use this information while processing and optimizing mappings.</span></p>
  </blockquote>
  <pre># Reordering Tokens =&gt; Top Bytes
[reorderingTokens     Arab    61=910 62=910 ]
[reorderingTokens     Armi    7A=22 ]
[reorderingTokens     Armn    5F=82 ]
[reorderingTokens     Avst    7A=54 ]
...</pre>
  <blockquote>
    <p>This table is an inverse mapping from reordering token to top byte(s).
    In terms like &quot;61=910&quot;, the first value is the top byte,
    while the second is informational,
    indicating the number of primaries assigned with that top byte.</p>
  </blockquote>
  <pre># General Categories =&gt; Top Byte
[categories   Cc      03{SPACE}=6 ]
[categories   Cf      77{Khmr Tale Talu Lana Cham Bali Java Mong Olck Cher Cans Ogam Runr Orkh Vaii Bamu}=2 ]
[categories   Lm      0D{SYMBOL}=25 0E{SYMBOL}=22 27{Latn}=12 28{Latn}=12 29{Latn}=12 2A{Latn}=12...</pre>
  <blockquote>
    <p>This table is informational, providing the top bytes, scripts, and primaries
    associated with each general category value. </p>
  </blockquote>
  <pre># FIXED VALUES
[fixed first implicit byte E0]
[fixed last implicit byte E4]
[fixed first trail byte E5]
[fixed last trail byte EF]
[fixed first special byte F0]
[fixed last special byte FF]

<span class="changed">[fixed secondary common byte 05]
[fixed last secondary common byte 45]
[fixed first ignorable secondary byte 80]

[fixed tertiary common byte 05]
[fixed first ignorable tertiary byte 3C]</span></pre>
  <blockquote>
    <p>The final table gives certain hard-coded byte values.
    The &quot;trail&quot; area is provided for implementation of the &quot;trailing weights&quot;
    as described in the UCA.</p>
  </blockquote>

<h4>UCA_Rules.txt</h4>
  <p>The format for this file uses the CLDR <span class="removed">basic</span> collation syntax,
  see <i>Section 3, <a href="#Collation_Tailorings">Collation Tailorings</a></i>.</p>


<h2><a name="Collation_Tailorings" href="#Collation_Tailorings">3 Collation Tailorings</a></h2>
        <p class="reviewnote">This draft removes the XML collation syntax, often without leaving "removed" markers.
        New or modified text is highlighted.
        For a detailed comparison see the <i><a href="http://www.unicode.org/reports/tr35/tr35-31/tr35-collation.html#Collation_Tailorings">CLDR 23 version of this document</a></i>.</p>
        <p class="reviewnote">Please ignore minor style and wording issues for now.
        This chapter has other, more significant problems and needs to be mostly rewritten, scheduled for CLDR 24.</p>
	<p class="dtd">&lt;!ELEMENT collations (alias | (<span class="changed">defaultCollation?</span><span class="removed">default*</span>, collation*, special*)) &gt;</p>
	<p>This element of the LDML format
	contains one or more <span class="element">collation</span> elements, distinguished by type.
	Each <span class="element">collation</span> contains
	<span class="changed">elements with parametric settings,
	or</span> rules that specify a certain sort order, as a tailoring of the root order,
	<span class="changed">or both</span>.</p>

    <p>To allow implementations in reduced memory environments to use CJK sorting,
    there are also short forms of each of these collation sequences.
    These provide for the most common characters in common use,
    and are marked with <span class="attribute">alt</span>=&quot;<span class="attributeValue">short</span>&quot;.</p>

  <p class="removed">There are two syntaxes for specifying collation rules:
  the <em>basic collation syntax</em> and the <em>XML collation syntax</em>.
  Both have the same functionality.
  The LDML files use the XML format, but the basic format is simpler to read, and will often be used in examples.
  Implementations of LDML, such as [<a href="tr35.html#ICUCollation">ICUCollation</a>], may choose to use the basic collation syntax as their native syntax.</p>

  <p class="changed">Each locale may have multiple sort orders.
  The <span class="element">defaultCollation</span> element defines the default tailoring for a locale and its sublocales.
  For example:</p>
  <ul class="changed">
    <li>root.xml: <code>&lt;defaultCollation&gt;standard&lt;/defaultCollation&gt;</code></li>
    <li>zh.xml: <code>&lt;defaultCollation&gt;pinyin&lt;/defaultCollation&gt;</code></li>
    <li>zh_Hant.xml: <code>&lt;defaultCollation&gt;stroke&lt;/defaultCollation&gt;</code></li>
  </ul>

  <p class="note"><b>Note:</b></p>
	<ul>
	  <li class="note">There is an on-line demonstration of collation at [<a href="tr35.html#LocaleExplorer">LocaleExplorer</a>] <span class="removed">that uses the basic syntax</span>.
	    (Pick the locale and scroll to &quot;Collation Rules&quot;, near the end.)</li>
	  <li class="note changed">In CLDR 23 and before, LDML collation files used an XML format.
	    Starting with CLDR 24, the XML collation syntax is deprecated and no longer used.
	    See the <i><a href="http://www.unicode.org/reports/tr35/tr35-31/tr35-collation.html#Collation_Tailorings">CLDR 23 version of this document</a></i>
	    for details about the XML collation syntax.</li>
  </ul>
<h3><a name="Collation_Version" href="#Collation_Version">3.1 Version</a></h3>
	<p>The version attribute is used in case a specific version of the UCA is to be specified. It is optional, and is specified if the results are to be identical 
	on different systems. If it is not supplied, then the version is assumed to be the same as the Unicode version for the system as a whole. In general, tailorings 
	should be defined so as to minimize dependence on the underlying UCA version, by explicitly specifying the behavior of all characters used to write the language 
	in question.</p>
	<blockquote>
		<p><b>Note: </b>For version 3.1.1 of the UCA, the version of Unicode must also be specified with any versioning information; an example would be &quot;3.1.1/3.2&quot; 
		for version 3.1.1 of the UCA, for version 3.2 of Unicode. This was changed by decision of the UTC, 
		so that dual versions were no longer necessary. So for UCA 4.0 and beyond, the version just has a single number.</p>
	</blockquote>

	<h3><a name="Collation_Element" href="#Collation_Element">3.2 Collation Element</a></h3>
	<p class="dtd">&lt;!ELEMENT collation (alias | (<span class="removed">base?,</span> <span class="changed">import*,</span> settings?, suppress_contractions?, optimize?, <span class="removed">rules?</span> <span class="changed">cr*</span>, special*)) &gt;</p>
	<p>The tailoring syntax is designed to be independent of the actual weights used in any particular UCA table. That way the same rules can 
  be applied to UCA versions over time, even if the underlying weights change.
  The following illustrates the overall structure of a <span class="element">collation</span> <span class="removed">with the XML syntax</span>:</p>
	<pre class="changed">&lt;collation&gt;
  &lt;settings caseLevel=&quot;on&quot;/&gt;
  &lt;cr&gt;&lt;![CDATA[
    &amp;c &lt; k
  ]]&gt;&lt;/cr&gt;
&lt;/collation&gt;</pre>
	<p class="removed">The basic syntax corresponding to this would be:</p>
	<p class="removed">[caseLevel on]<br>     &amp; c &lt; k</p>
<p class="removed">The optional base element <code>&lt;base&gt;<span style="color: blue">...</span>&lt;/base&gt;</code>, contains an alias element that points to another data source that 
	defines a <i>base </i>collation. If present, it indicates that the settings and rules in the collation are modifications applied on <i>top of the</i> respective 
	elements in the base collation. That is, any successive settings, where present, override what is in the base as described in <a href="#Setting_Options">Setting 
	Options</a>. Any successive rules are concatenated to the end of the rules in the base. The results of multiple rules applying to the same characters is covered 
	in <a href="#Orderings">Orderings</a>.</p>

<h3><a name="Setting_Options" href="#Setting_Options">3.3 Setting Options</a></h3>
	<p><span class="removed">In XML syntax, these</span>
	<span class="changed">The following parametric settings</span> are attributes of &lt;settings&gt;.
	For example, &lt;setting strength=&quot;secondary&quot;&gt; will only compare strings based on their primary and secondary weights.
	In <span class="changed">rule</span> syntax, these are of the form [<em>keyword</em> <em>value</em>].</p>
	<p>If the attribute is not present, the CLDR default (or the default for the locale, if there is one) is used.
	That  default is listed in bold italics.
	Where there is a UCA default that is different, it is listed in bold with (<strong>UCA default</strong>).
	Note that the default value for a locale may be different than the default value for the attribute,
	so the defaults here are <em>not</em> defaults for the corresponding keywords.</p>
  <p>The Example cells include <span class="removed">an LDML example followed by the same example in basic syntax</span>
  <span class="changed"><span class="element">settings</span> attributes as well as rule syntax</span>.
  In LDML files, parametric settings should be specified via <span class="element">settings</span> attributes,
  rather than in the rules.</p>
	<table>
    <caption><a name="Collation_Settings" href="#Collation_Settings">Collation Settings</a></caption>
		<tr>
		  <th>BCP47 Key</th>
			<th>Attribute</th>
			<th>BCP47 Value</th>
			<th>Options</th>
			<th>Example&nbsp; </th>
			<th>Description</th>
		</tr>
		<tr>
		  <td rowspan="5">ks</td>
			<td rowspan="5"><font color="#000000">strength</font></td>
			<td>level1</td>
			<td>primary (1)<br></td>
			<td rowspan="5"><code>strength = &quot;<span style="color: blue">primary</span>&quot;<br>
			  <br>
		    [strength 1]</code></td>
			<td rowspan="5">Sets the default strength for comparison, as described in the [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>].<em> Note that strength setting of greater than 4 may have the same effect as <strong>identical</strong>, depending on the locale and implementation.</em></td>
		</tr>
		<tr>
		  <td>level2</td>
		  <td>secondary (2)</td>
	  </tr>
		<tr>
		  <td>level3</td>
		  <td><em><strong>tertiary (3)</strong></em></td>
	  </tr>
		<tr>
		  <td>level4</td>
		  <td>quaternary (4)</td>
	  </tr>
		<tr>
		  <td>identic</td>
		  <td>identical (5)</td>
	  </tr>
		<tr>
		  <td rowspan="3">ka</td>
			<td rowspan="3">alternate</td>
			<td>noignore</td>
			<td><i><strong>non-ignorable</strong></i><br></td>
			<td rowspan="3"><code>alternate = &quot;<span style="color: blue">non-ignorable</span>&quot;<br>
		    <br>
		    [alternate non-ignorable]</code></td>
			<td rowspan="3">Sets alternate handling for variable weights, as described in [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>], where &quot;shifted&quot; causes certain characters to be ignored in comparison. <em>The default for LDML is different than it is in the UCA.
			In LDML, the default for alternate handling is <strong>non-ignorable</strong>, while in UCA it is <strong>shifted</strong>. In addition, in LDML only whitespace and punctuation are variable.</em></td>
		</tr>
		<tr>
		  <td>shifted</td>
		  <td><strong>shifted (UCA default)</strong></td>
	  </tr>
		<tr>
		  <td><em>n/a</em></td>
		  <td><i>blanked</i></td>
	  </tr>
		<tr>
		  <td rowspan="2">kb</td>
			<td rowspan="2">backwards</td>
			<td>true</td>
			<td>on</td>
			<td rowspan="2"><code>backwards = &quot;<span style="color: blue">on</span>&quot;<br>
			  <br>
		    [backwards 2]</code></td>
			<td rowspan="2">Sets the comparison for the second level to be <strong>backwards</strong>, as described in
			[<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>].</td>
		</tr>
		<tr>
		  <td>false</td>
		  <td><i><strong>off</strong></i></td>
	  </tr>
		<tr>
		  <td rowspan="2">kk</td>
			<td rowspan="2">normalization</td>
			<td>true</td>
			<td><strong>on (UCA default)</strong></td>
			<td rowspan="2"><code>normalization = &quot;<span style="color: blue">off</span>&quot;<br>
<br>
[normalization off]			</code></td>
			<td rowspan="2">If <strong>on</strong>, then the normal [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>] algorithm is used.
			If <strong>off</strong>, then all strings that are in [<a href="tr35.html#FCD">FCD</a>]
			and do not contain any composite combining marks
			will sort correctly,
			but others will not necessarily sort correctly.<br>
			So should only be set <strong>off</strong> if the the strings to be compared are in FCD
			and do not contain any composite combining marks.
			Composite combining marks are: { U+0344, U+0F73, U+0F75, U+0F81 }
			<a href="http://unicode.org/cldr/utility/list-unicodeset.jsp?a=%5B%3A%5Elccc%3D0%3A%5D%26%5B%3AtoNFD%3D%2F..%2F%3A%5D&amp;abb=on&amp;g=">[[:^lccc=0:]&amp;[:toNFD=/../:]]</a>
			(These characters must be decomposed for discontiguous contractions to work properly.
			Use of these characters is discouraged by the Unicode Standard.)<br>
			<em>Note that the default for CLDR locales may be different than in the UCA.
			The rules for particular locales have it set to <strong>on</strong>:
			those locales whose exemplar characters (in forms commonly interchanged)
			would be affected by normalization.</em></td>
		</tr>
		<tr>
		  <td>false</td>
		  <td><i><strong>off</strong></i></td>
	  </tr>
		<tr>
		  <td rowspan="2">kc</td>
			<td rowspan="2">caseLevel</td>
			<td>true</td>
			<td>on</td>
			<td rowspan="2"><code>caseLevel = &quot;<span style="color: blue">off</span>&quot;<br>
			  <br>
			  [caseLevel on]<br>
            </code></td>
			<td rowspan="2">If set to <strong>on</strong><i>,</i> a level consisting only of case characteristics will be inserted in front of tertiary level, as a &quot;Level 2.5&quot;. To ignore accents but take case 
			into account, set strength to <strong>primary</strong> and case level to <strong>on</strong>. For details, see <em>Section 3.13, <a href="#Case_Parameters">Case Parameters</a></em>.</td>
		</tr>
		<tr>
		  <td>false</td>
		  <td><i><strong>off</strong></i></td>
	  </tr>
		<tr>
		  <td rowspan="3">kf</td>
			<td rowspan="3">caseFirst</td>
			<td>upper</td>
			<td>upper</td>
			<td rowspan="3"><code>caseFirst = &quot;<span style="color: blue">off</span>&quot;<br>
			  <br>
		    [caseFirst off]</code></td>
			<td rowspan="3">If set to <strong>upper</strong>, causes upper case to sort before lower case. If set to <strong>lower</strong>, causes lower case to sort before upper case. Useful for 
			locales that have already supported ordering but require different order of cases. Affects case and tertiary levels. For details, see <em>Section 3.13, <a href="#Case_Parameters">Case Parameters</a></em>.</td>
		</tr>
		<tr>
		  <td>lower</td>
		  <td>lower</td>
	  </tr>
		<tr>
		  <td>false</td>
		  <td><i><strong>off</strong></i></td>
	  </tr>
		<tr>
		  <td rowspan="2">kh</td>
			<td rowspan="2">hiraganaQuaternary</td>
			<td>true</td>
			<td>on</td>
			<td rowspan="2"><code>		    hiragana¬≠Quaternary = &quot;<span style="color: blue">on</span>&quot;			<br>
			  <br>
		    [hiraganaQ on]			</code></td>
			<td rowspan="2">Controls special treatment of Hiragana code points on quaternary level. If turned <strong>on</strong>, Hiragana codepoints will get lower values than all 
			the other non-variable code points in <strong>shifted</strong>. That is, the normal Level 4 value for a regular collation element is FFFF, as described in [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>], <em>Section 3.6.2, Variable Weighting</em>. This is changed to FFFE for [:script=Hiragana:] characters. The strength must be greater or equal than quaternary if this attribute is to have any effect.</td>
		</tr>
		<tr>
		  <td>false</td>
		  <td><i><strong>off</strong></i></td>
	  </tr>
		<tr>
		  <td rowspan="2">kn</td>
			<td rowspan="2">numeric</td>
			<td>true</td>
			<td>on</td>
			<td rowspan="2"><code>numeric = &quot;<span style="color: blue">on</span>&quot;<br>
			  <br>
		    [numeric on]</code></td>
			<td rowspan="2">If set to <strong>on</strong>, any sequence of Decimal Digits (General_Category = Nd in the [<a href="http://www.unicode.org/reports/tr41/#UAX44">UAX44</a>])
			is sorted at a primary level with its numeric value. For example, &quot;A-21&quot; &lt; &quot;A-123&quot;. The computed primary weights are all at the start of the <strong>digit</strong> reordering group. Thus with an untailored UCA table, &quot;a$&quot; &lt; &quot;a0&quot; &lt; &quot;a2&quot; &lt; &quot;a12&quot; &lt; &quot;a‚ì™&quot; &lt; &quot;aa&quot;.</td>
		</tr>
		<tr>
		  <td>false</td>
		  <td><i><strong>off</strong></i></td>
	  </tr>
		<tr>
		  <td>vt</td>
			<td>variableTop</td>
			<td>See <i>Appendix Q: <a href="tr35.html#Locale_Extension_Key_and_Type_Data">Locale Extension
			Keys and Types</a>.</i></td>
			<td>uXXuYYYY<br>
		      <br>
		    (the default is set to the highest punctuation, thus including spaces and punctuation, but not symbols)</td>
			<td><code>variableTop = &quot;<span style="color: blue">uXXuYYYY</span>&quot;<br>
			  <br>
		    &amp; \u00XX\uYYYY &lt; [variable top]</code></td>
			<td><p>The Option value is an encoded Unicode string, with code points in hex, leading zeros removed, and &#39;u&#39; inserted between successive elements. </p>
			  <p>The BCP47 value is described in <i>Appendix Q: <a href="tr35.html#Locale_Extension_Key_and_Type_Data">Locale Extension
			    Keys and Types</a>.</i> </p>			  <p>
		  Sets the  string value for the variable top. All the code points with primary strengths less than or equal to that string will be considered variable, and thus 
			affected by the alternate handling. Variables are ignorable by default in [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>], but not in CLDR. See below for more information.</p>
		  </td>
		</tr>
		<tr>
		  <td>kr</td>
		  <td>reorder</td>
		  <td colspan="2">a sequence of one or more reorder codes: <strong>space, punct, symbol, currency, digit</strong>, or any BCP47 script ID</td>
		  <td><code>reorder = &quot;Grek digit&quot;<br>
	      <br>
	      [reorder Grek  digit]</code></td>
		  <td>Specifies a reordering of scripts or other significant blocks of characters such as symbols, punctuation, and digits. 
	      For the precise meaning and usage of the reorder codes, see <em>Section 3.12, <a href="#Script_Reordering">Collation Reordering</a>.</em></td>
	  </tr>
		<tr>
		  <td rowspan="3"><em>n/a</em></td>
			<td rowspan="3">match-boundaries:</td>
			<td nowrap><em>n/a</em></td>
			<td nowrap><em><strong>none</strong></em><br></td>
			<td rowspan="3"><code>match-boundaries = &quot;<span style="color: blue">whole-word</span>&quot;</code><br>
			  <br>
		    n/a<br></td>
			<td rowspan="3">Defined by  <em>Section 8, Searching and Matching</em> of [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>].</td>
		</tr>
		<tr>
		  <td nowrap><em>n/a</em></td>
		  <td nowrap>whole-character</td>
	  </tr>
		<tr>
		  <td nowrap><em>n/a</em></td>
		  <td nowrap>whole-word</td>
	  </tr>
		<tr>
		  <td rowspan="3"><em>n/a</em></td>
			<td rowspan="3">match-style</td>
			<td><em>n/a</em></td>
			<td><em><strong>minimal</strong></em><br></td>
			<td rowspan="3"><code>match-style = &quot;<span style="color: blue">medial</span>&quot;</code><br>
			  <br>
		    n/a</td>
			<td rowspan="3">Defined by <em>Section 8, Searching and Matching</em> of [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>].</td>
		</tr>
		<tr>
		  <td><em>n/a</em></td>
		  <td>medial</td>
	  </tr>
		<tr>
		  <td><em>n/a</em></td>
		  <td>maximal</td>
	  </tr>
  </table>
  <p><strong>Variable Top (vt) </strong>bears more explanation. Users may want to include more or fewer characters as Variable.¬†For example, someone could want to restrict the Variable characters to just include space marks. In that case, variableTop would be set to U+1680 (see¬†<a href="http://unicode.org/charts/collation/chart_Variable.html">UCA Variable chart</a>).¬†Alternatively, someone could want more of the Common characters in them, and include characters up to (but not including '0'), by setting variableTop to be U+20BA (in Unicode 6.2; see¬†<a href="http://unicode.org/charts/collation/chart_Common.html">UCA Common chart</a>).</p>
  <p>The effect of these settings is to customize to ignore different sets of characters when comparing strings. For example, the locale identifier "de-u-ka-shifted-vt-0024" is requesting  settings appropriate for German, including German sorting conventions, and that '$' and characters sorting below it are ignored in sorting.
  </p>

  <h3><a name="Rules" href="#Rules">3.4 Collation Rule Syntax</a></h3>
  <p class="dtd"><span class="changed">&lt;!ELEMENT cr #PCDATA &gt;</span></p>
	<p>The goal for the collation rule syntax is to have clearly expressed rules with a concise format<span class="removed">, that parallels the basic syntax as much as possible.
	The rule syntax uses abbreviated element names for primary (level 1), secondary (level 2), tertiary (level 3), and identical, to be as short as possible.
	The reason for this is because the tailorings for CJK characters are quite large (tens of thousands of elements),
	and the extra overhead would have been considerable. 
	Other elements and attributes do not occur as frequently, and have longer names</span>.
	<span class="changed">The CLDR rule syntax is a subset of the [<a href="tr35.html#ICUCollation">ICUCollation</a>] syntax.</span></p>
	<blockquote>
		<p><b>Note: </b>The rules are stated in terms of actions that cause characters to change their ordering relative to other characters.
		This is for stability; assigning characters specific weights would not work,
		since the exact weight assignment <span class="removed">in UCA (or ISO 14651)</span> is not required for conformance 
		‚Äî only the relative ordering of the weights.
		In addition, stating rules in terms of relative order is much less sensitive to changes over time
		in the <span class="changed">root order</span>.</p>
	</blockquote>

	<h3><a name="Orderings" href="#Orderings">3.5 Orderings</a></h3>
	<p>The following are the normal ordering actions used for the bulk of characters.
	Each rule contains a string of ordered characters that starts with an anchor point or a reset value.
	The reset value is an absolute point in the <span class="changed">root order</span> that determines the order of other characters.
	For example, the rule &amp; a &lt; g, places 
	&quot;g&quot; after &quot;a&quot; <span class="removed">in a tailored UCA</span>: the &quot;a&quot; does not change place.
	Logically, subsequent rule after a reset indicates a change to the ordering (and comparison 
	strength) of the characters in the <span class="changed">root order</span>.
	For example, the <span class="changed">root order</span> has the following sequence (abbreviated for illustration):</p>
	<blockquote>
		<p>... a &lt;<sub>3</sub> ÔΩÅ &lt;<sub>3</sub> ‚ìê &lt;<sub>3</sub> A &lt;<sub>3</sub> Ôº° &lt;<sub>3</sub> ‚í∂ &lt;<sub>3</sub> ¬™ &lt;<sub>2</sub> √° &lt;<sub>3</sub> √Å &lt;<sub>1</sub> √¶ &lt;<sub>3</sub> 
	√Ü &lt;<sub>1</sub> …ê &lt;<sub>1</sub> …ë &lt;<sub>1</sub> …í &lt;<sub>1</sub> b &lt;<sub>3</sub> ÔΩÇ &lt;<sub>3</sub> ‚ìë &lt;<sub>3</sub> B &lt;<sub>3</sub> Ôº¢ &lt;<sub>3</sub> ‚Ñ¨ ...</p>
	</blockquote>
	<p>Whenever a character is inserted into the <span class="changed">root</span> sequence,
	it is inserted at the first point where the strength difference will not disturb the other characters 
	in the <span class="changed">root order</span>.
	For example, &amp; a &lt; g puts <i>g</i> in the above sequence with a strength of L1.
	Thus the <i>g</i> must go in after any lower strengths,&nbsp; as follows:</p>
	<blockquote>
		<p>... a &lt;<sub>3</sub> ÔΩÅ &lt;<sub>3</sub> ‚ìê &lt;<sub>3</sub> A &lt;<sub>3</sub> Ôº° &lt;<sub>3</sub> ‚í∂ &lt;<sub>3</sub> ¬™ &lt;<sub>2</sub> √° &lt;<sub>3</sub> √Å 
		<b><font color="red">&lt;<sub>1</sub> g </font></b>&lt;<sub>1</sub> √¶ &lt;<sub>3</sub> √Ü &lt;<sub>1</sub> …ê &lt;<sub>1</sub> …ë &lt;<sub>1</sub> …í &lt;<sub>1</sub> b &lt;<sub>3</sub> ÔΩÇ 
	&lt;<sub>3</sub> ‚ìë &lt;<sub>3</sub> B &lt;<sub>3</sub> Ôº¢ &lt;<sub>3</sub> ‚Ñ¨ ...</p>
	</blockquote>
	<p>The rule &amp; a &lt;&lt; g, which uses a level-2 strength, would produce the following sequence:</p>
	<blockquote>
		<p>... a &lt;<sub>3</sub> ÔΩÅ &lt;<sub>3</sub> ‚ìê &lt;<sub>3</sub> A &lt;<sub>3</sub> Ôº° &lt;<sub>3</sub> ‚í∂ &lt;<sub>3</sub> ¬™ 
		<b><font color="red">&lt;<sub>2</sub> g</font></b> &lt;<sub>2</sub> 
	√° &lt;<sub>3</sub> √Å<b><font color="red"> </font></b>&lt;<sub>1</sub> √¶ &lt;<sub>3</sub> √Ü &lt;<sub>1</sub> …ê &lt;<sub>1</sub> …ë &lt;<sub>1</sub> …í &lt;<sub>1</sub> b &lt;<sub>3</sub> 
	ÔΩÇ &lt;<sub>3</sub> ‚ìë &lt;<sub>3</sub> B &lt;<sub>3</sub> Ôº¢ &lt;<sub>3</sub> ‚Ñ¨ ...</p>
	</blockquote>
	<p>And the rule &amp; a &lt;&lt;&lt; g, which uses a level-3 strength, would produce the following sequence:</p>
	<blockquote>
		<p>... a <b><font color="red">&lt;<sub>3</sub> g</font></b> &lt;<sub>3</sub> ÔΩÅ &lt;<sub>3</sub> ‚ìê &lt;<sub>3</sub> A &lt;<sub>3</sub> Ôº° &lt;<sub>3</sub> ‚í∂ &lt;<sub>3</sub> ¬™ &lt;<sub>2</sub> 
	√° &lt;<sub>3</sub> √Å<b><font color="red"> </font></b>&lt;<sub>1</sub> √¶ &lt;<sub>3</sub> √Ü &lt;<sub>1</sub> …ê &lt;<sub>1</sub> …ë &lt;<sub>1</sub> …í &lt;<sub>1</sub> b &lt;<sub>3</sub> 
	ÔΩÇ &lt;<sub>3</sub> ‚ìë &lt;<sub>3</sub> B &lt;<sub>3</sub> Ôº¢ &lt;<sub>3</sub> ‚Ñ¨ ...</p>
	</blockquote>
	<p>Since resets always work on the existing state, the rule entries must be in the proper order. A character or sequence may occur multiple times; each subsequent 
	occurrence causes a different change. The following shows the result of serially applying three rules.</p>
	<table>
		<tr>
			<th>&nbsp;</th>
			<th><span class="changed">Rules</span></th>
			<th>Result</th>
			<th>Comment</th>
		</tr>
		<tr>
			<td>1</td>
			<td>&amp; a &lt; g</td>
			<td>... a<font color="red"> &lt;<sub>1</sub> g</font> ...</td>
			<td>Put g after a.</td>
		</tr>
		<tr>
			<td>2</td>
			<td>&amp; a &lt; h &lt; k</td>
			<td>... a<font color="red"> &lt;<sub>1</sub> h &lt;<sub>1</sub> k</font> &lt;<sub>1</sub> g ...</td>
			<td>Now put h and k after a (inserting before the g).</td>
		</tr>
		<tr>
			<td>3</td>
			<td>&amp; h &lt;&lt; g</td>
			<td>... a &lt;<sub>1</sub> h<font color="red"> &lt;<sub>1</sub> g</font> &lt;<sub>1</sub> k ...</td>
			<td>Now put g after h (inserting before k).</td>
		</tr>
	</table>
	<p>Notice that characters can occur multiple times, and thus override previous rules.</p>
	<p>Except for the case of expansion sequence syntax, every sequence after a reset is equivalent in action to breaking up the sequence into an <i>atomic</i> 
	rule: a reset + relation pair. The tailoring is then equivalent to applying each of the atomic rules to the UCA in order, according to the above description.</p>
	<p><i>Example:</i></p>
	<table>
		<tr>
			<th><span class="changed">Rules</span></th>
			<th>Equivalent Atomic Rules</th>
		</tr>
		<tr>
			<td>&amp; b &lt; q &lt;&lt;&lt; Q<br>
			&amp; a &lt; x &lt;&lt;&lt; X &lt;&lt; q &lt;&lt;&lt; Q &lt; z</td>
			<td>&amp; b &lt; q<br>
			&amp; q &lt;&lt;&lt; Q<br>
			&amp; a &lt; x<br>
			&amp; x &lt;&lt;&lt; X<br>
			&amp; X &lt;&lt; q<br>
			&amp; q &lt;&lt;&lt; Q<br>
			&amp; Q &lt; z</td>
		</tr>
	</table>
	<p>In the case of expansion sequence syntax, the equivalent atomic sequence can be derived by first transforming the expansion sequence syntax into normal expansion 
	syntax. (See <a href="#Expansions">Expansions</a>.)</p>
	<p class="removed"><span class="dtd">&lt;!ELEMENT reset ( #PCDATA | cp | ... )* &gt;<br>
	&lt;!ELEMENT p ( #PCDATA | cp | last_variable )* &gt;<br>
	</span>(Elements pc, s, sc, t, tc, i, and ic have the same structure as p.)</p>
	<span class="changed">A reset is followed by one or more relations.</span>
	<table>
		<caption>Specifying Collation Ordering</caption>
		<tr>
			<th><span class="changed">Relation Operator</span></th>
			<th><span class="removed">Basic</span> Example</th>
			<th>Description</th>
		</tr>
		<tr>
			<td><code>&amp;&nbsp; </code></td>
			<td><code>&amp; Z&nbsp; </code></td>
			<td>Do not change the ordering of Z, but place subsequent characters relative to it.</td>
		</tr>
		<tr>
			<td><code>&lt;&nbsp; </code></td>
			<td><code>&amp; a<br>
			&lt; b&nbsp; </code></td>
			<td>Make &#39;b&#39; sort after &#39;a&#39;, as a <i>primary</i> (base-character) difference</td>
		</tr>
		<tr>
			<td><code>&lt;&lt;&nbsp; </code></td>
			<td><code>&amp; a<br>
			&lt;&lt; √§&nbsp; </code></td>
			<td>Make &#39;√§&#39; sort after &#39;a&#39; as a <i>secondary</i> (accent) difference</td>
		</tr>
		<tr>
			<td><code>&lt;&lt;&lt;&nbsp; </code></td>
			<td><code>&amp; a<br>
			&lt;&lt;&lt; A&nbsp; </code></td>
			<td>Make &#39;A&#39; sort after &#39;a&#39; as a <i>tertiary</i> (case/variant) difference</td>
		</tr>
		<tr>
			<td><code>=&nbsp; </code></td>
			<td><code>&amp; v<br>
			= w&nbsp; </code></td>
			<td>Make &#39;w&#39; sort <i>identically</i> to &#39;v&#39;</td>
		</tr>
	</table>
	<p class="removed">Resets only need to be at the start of a sequence, to position the characters relative a character that is in the UCA (or has already occurred in the tailoring). 
	For example: &lt;reset&gt;z&lt;/reset&gt;&lt;p&gt;a&lt;/p&gt;&lt;p&gt;b&lt;/p&gt;&lt;p&gt;c&lt;/p&gt;&lt;p&gt;d&lt;/p&gt;.</p>
	<p>Some additional <span class="changed">operators</span> are provided to save space with large tailorings.
	The addition of a <span class="changed">*</span> to the <span class="changed">relation operator</span>
	indicates that each of the <span class="changed">following single</span> characters
	<span class="removed">in the contents of that element</span> are to be handled as if they were separate <span class="changed">relations</span> with the corresponding strength.
	<span class="removed">In the basic syntax, these are expressed by adding a * to the operation.</span></p>
	<table>
    <caption>Abbreviating Ordering Specifications</caption>
		<tr>
		  <th><span class="changed">Relation Operator</span></th>
		  <th><span class="removed">Basic</span> Example</th>
		  <th>Equivalent</th>
		</tr>
		<tr>
		  <td><code>&lt;*</code></td>
		  <td><code>&amp; <span style="color: blue">a</span><br>
  &lt;* <span style="color: blue">bcd</span>&nbsp;</code></td>
		  <td><code>&amp; <span style="color: blue">a</span><br>
  &lt; <span style="color: blue">b </span>&lt;<span style="color: blue"> c </span>&lt;<span style="color: blue"> d</span>&nbsp;</code></td>
		</tr>
		<tr>
		  <td><code>&lt;&lt;</code><code>*</code></td>
		  <td><code>&amp;<span style="color: blue"> a</span><br>
  &lt;&lt;*<span style="color: blue"> √†√°√¢√£</span></code></td>
		  <td><code>&amp;<span style="color: blue"> a</span><br>
  &lt;&lt;<span style="color: blue"> √† </span>&lt;&lt; <span style="color: blue">√° </span>&lt;&lt; <span style="color: blue">√¢√£</span></code></td>
		</tr>
		<tr>
		  <td><code>&lt;&lt;&lt;</code><code>*</code></td>
		  <td><code>&amp;<span style="color: blue"> p</span><br>
  &lt;&lt;&lt;* <span style="color: blue">PÔΩêÔº∞</span></code></td>
		  <td><code>&amp;<span style="color: blue"> p</span><br>
  &lt;&lt;&lt; <span style="color: blue">P</span> &lt;&lt;&lt; <span style="color: blue">ÔΩê</span> &lt;&lt;&lt; <span style="color: blue">Ôº∞</span></code></td>
		</tr>
		<tr>
		  <td><code>=*</code></td>
		  <td><code>&amp;<span style="color: blue"> v</span><br>
	      =* <span style="color: blue">VwW</span></code></td>
		  <td><code>&amp;<span style="color: blue"> v</span><br>
		    = <span style="color: blue">V </span>= <span style="color: blue">w </span>= <span style="color: blue">W</span></code></td>
		</tr>
	</table>
<h3><a name="Contractions" href="#Contractions">3.6 Contractions</a></h3>
	<p>To sort a sequence as a single item (contraction), just use the sequence, 
	for example,</p>
	<table>
		<caption>Specifying Contractions</caption>
		<tr>
			<th><span class="removed">Basic</span> Example</th>
			<th>Description</th>
		</tr>
		<tr>
			<td><code>&amp; k<br>
			&lt; ch</code></td>
			<td>Make the sequence &#39;ch&#39; sort after &#39;k&#39;, as a primary (base-character) difference</td>
		</tr>
	</table>

	<h3><a name="Expansions" href="#Expansions">3.7 Expansions</a></h3>
	<p class="dtd removed">&lt;!ELEMENT x (context?, ( p | pc | s | sc | t | tc | i | ic )*, extend? ) &gt;</p>
	<p>There are two ways to handle expansions (where a character sorts as a sequence) <span class="removed">with both the basic syntax and the XML syntax</span>.
	The first method is to reset to the sequence of characters.
	This is called <i>sequence expansion syntax.</i>
	The second is to use the extension sequence. This is called <i>normal expansion syntax</i>.
	Both are equivalent in practice (unless the reset sequence happens to be a contraction).</p>
	<table>
		<caption>Specifying Expansions</caption>
		<tr>
			<th><span class="changed">Rules</span></th>
			<th>Description</th>
		</tr>
		<tr>
			<td><code>&amp; c <br>
			&lt;&lt; k / h</code></td>
			<td><i>normal expansion syntax:<br>
			</i>Make &#39;k&#39; sort after the sequence &#39;ch&#39;; thus &#39;k&#39; will behave as if it expands to a character after &#39;c&#39; followed by an &#39;h&#39;.</td>
		</tr>
		<tr>
			<td><code>&amp; ch<br>
			&lt;&lt; k</code></td>
			<td><i>sequence expansion syntax:<br>
			</i>Make &#39;k&#39; sort after the sequence &#39;ch&#39;; thus &#39;k&#39; will behave as if it expands to a character after &#39;c&#39; followed by an &#39;h&#39;.
			<p><i>(unless &#39;ch&#39; is defined beforehand as a contraction).</i></p>
			</td>
		</tr>
	</table>
	<p class="removed">If an <code>&lt;extend&gt;</code> element is necessary, it requires the rule to be embedded in an &lt;x&gt; element.</p>
	<p>The sequence expansion syntax can be quite tricky, so it should be avoided where possible. In particular:</p>
	<ul>
		<li>The expansion is <i>only</i> in effect up to ‚Äî but not including ‚Äî the first primary rule. Thus
		<pre class="changed">&amp;ch &lt;&lt; x &lt;&lt;&lt; y &lt; z</pre>
		is the same as
		<pre class="changed">&amp;c &lt;&lt; x/h &lt;&lt;&lt; y/h &lt; z</pre></li>
		<li>In accordance with the UCA, all strings are interpreted as being in NFD form.
		In other rules, this has no effect, but syntax such as <code class="changed">&amp;</code><b>√§</b>, 
		the <b>√§</b> will be treated as two characters <b>a +&nbsp; ¬®</b>,
		<i>unless</i> the <b>√§</b> has previously been used as a contraction. Thus the <b>¬®</b> 
		will be used as an <span class="changed">extension</span> for following characters (up to the next primary).</li>
	</ul>
	<p>Each extension replaces the one before it; it does not append to it. So </p>
	<blockquote>
		<p>&amp; ab &lt;&lt; c<br>&amp; cd &lt;&lt; e</p>
	</blockquote>
	<p>is equivalent to:</p>
	<blockquote>
		<p>&amp; a &lt;&lt; c / b &lt;&lt; e / d</p>
	</blockquote>
	<p>and produces the following weights (where <i>p(x)</i> is the primary weight and <i>s(a)</i> is the secondary weight):</p>
	<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse">
		<tr>
			<td>Character</td>
			<td>Weights</td>
		</tr>
		<tr>
			<td>c</td>
			<td>p(a), p(b); s(a)+1, s(b); ...</td>
		</tr>
		<tr>
			<td>e</td>
			<td>p(a), p(d); s(a)+2, s(d); ...</td>
		</tr>
	</table>
	<p>When expressing rules as atomic rules, the sequences must first be transformed into normal expansion syntax:</p>
	<table>
		<tr>
			<th>Expansion Sequence</th>
			<th>Normal Expansion</th>
			<th>Equivalent Atomic Rules</th>
		</tr>
		<tr>
			<td>&amp; a<u>b</u> &lt;&lt; q &lt;&lt;&lt; Q<br>
			&amp; a<u>d</u> &lt;&lt;&lt; AD &lt; x &lt;&lt;&lt; X</td>
			<td>&amp; a &lt;&lt; q <u>/ b</u> &lt;&lt;&lt; Q <u>/ b</u><br>
			&amp; a &lt;&lt;&lt; AD <u>/ d</u> &lt; x &lt;&lt;&lt; X</td>
			<td>&amp; a &lt;&lt; q <u>/ b</u><br>
			&amp; q &lt;&lt;&lt; Q <u>/ b</u><br>
			&amp; a &lt;&lt;&lt; AD <u>/ d</u><br>
			&amp; AD &lt; x<br>
			&amp; x&lt;&lt;&lt; X</td>
		</tr>
	</table>

	<h3><a name="Context_Before" href="#Context_Before">3.8 Context Before</a></h3>
	<p class="removed">The context before a character can affect how it is ordered, such as in Japanese. This could be expressed with a combination of contractions and expansions, 
	but is faster using a context. (The actual weights produced are different, but the resulting string comparisons are the same.)
	If a context element occurs, it must be the first item in the rule, and requires an &lt;x&gt; element.</p>
	<p class="changed">A relation string can have a prefix (context before)
	which makes the mapping from the relation string to its tailored position
	conditional on the string occurring after that prefix.
	For details see the specification of <i><a href="#Context_Sensitive_Mappings">Context-Sensitive Mappings</a></i>.</p>
	<p>For example, suppose that &quot;-&quot; is sorted like the previous vowel.
	Then one could have rules that take &quot;a-&quot;, &quot;e-&quot;, and so on.
	However, that means that every time a very common character (a, e, ...) is encountered,
	a system will slow down as it looks for possible contractions. An alternative is to indicate that when 
	&quot;-&quot; is encountered, and it comes after an &#39;a&#39;, it sorts 
	like an &#39;a&#39;, and so on. </p>
	<table>
		<caption>Specifying Previous Context</caption>
		<tr>
			<th><span class="changed">Rules</span></th>
		</tr>
		<tr>
			<td><code>&amp; a &lt;&lt;&lt; a | '-'<br>
			&amp; e &lt;&lt;&lt; e | '-'<br>
			...</code></td>
		</tr>
	</table>
	<p>Both the context and extend elements can occur in <span class="changed">a relation</span>.
	For example, the following are allowed:</p>
	<ul class="changed">
		<li><code>&lt; abc | def / ghi</code></li>
		<li><code>&lt; def / ghi</code></li>
		<li><code>&lt; abc | def</code></li>
	</ul>
	<h3><a name="Placing_Characters_Before_Others" href="#Placing_Characters_Before_Others">3.9 Placing Characters Before Others</a></h3>
	<p>There are certain circumstances where characters need to be placed before a given character, rather than after. This is the case with Pinyin, for example, 
	where certain accented letters are positioned before the base letter. That is accomplished with the following syntax.</p>
	<pre>&amp;[before 2] a &lt;&lt; √†</pre>
	<p class="changed">The before-strength can be 1 (primary), 2 (secondary), or 3 (tertiary).</p>
	<p>It is an error if the strength of the <span class="changed">reset-before differs from the strength of the immediately following relation</span>.
	Thus the following are errors<span class="removed">, since the value of 
	the <i>before</i> attribute does not agree with the relation &lt;s&gt;</span>.</p>
	<ul class="changed">
		<li><code>&amp;[before 2] a &lt; √† # error</code></li>
		<li><code>&amp;[before 2] a &lt;&lt;&lt; √† # error</code></li>
	</ul>

	<h3><a name="Logical_Reset_Positions" href="#Logical_Reset_Positions">3.10 Logical Reset Positions</a></h3>
	<p class="dtd removed">&lt;!ELEMENT reset ( ... | first_variable| last_variable | first_tertiary_ignorable | last_tertiary_ignorable | first_secondary_ignorable 
	| last_secondary_ignorable | first_primary_ignorable | last_primary_ignorable | first_non_ignorable | last_non_ignorable | first_trailing | last_trailing )* 
	&gt;</p>
	<p>The CLDR table (based on UCA) has the following overall structure for weights, going from low to high.</p>
	<table>
		<caption>Specifying Logical Positions</caption>
		<tr>
			<th>Name</th>
			<th>Description</th>
			<th>UCA Examples</th>
		</tr>
		<tr>
			<td>first tertiary ignorable<br>
			...<br>
			last tertiary ignorable</td>
			<td>p, s, t = ignore</td>
			<td>Control Codes<br>
			Format Characters<br>
			Hebrew Points<br>
			Tibetan Signs<br>
			...</td>
		</tr>
		<tr>
			<td>first secondary ignorable<br>
			...<br>
			last secondary ignorable</td>
			<td>p, s = ignore</td>
			<td>None in UCA</td>
		</tr>
		<tr>
			<td>first primary ignorable<br>
			...<br>
			last primary ignorable</td>
			<td>p = ignore</td>
			<td>Most combining marks</td>
		</tr>
		<tr>
			<td>first variable<br>
			...<br>
			last variable</td>
			<td><i><b>if</b> alternate = non-ignorable<br>
			</i>p != ignore,<br>
			<i><b>if</b> alternate = shifted</i><br>
			p, s, t = ignore</td>
			<td>Whitespace,<br>
			Punctuation</td>
		</tr>
		<tr>
			<td>first non-ignorable<br>
			...<br>
			last non-ignorable</td>
			<td>p != ignore</td>
			<td>General Symbols<br>
		    Currency Symbols<br>
            Numbers<br>
			Latin<br>
			Greek<br>
		  ...</td>
		</tr>
		<tr>
			<td><i>implicits</i></td>
			<td>p != ignore, assigned automatically</td>
			<td>CJK, CJK compatibility (those that are not decomposed)<br>
			CJK Extension A, B<br>
			Unassigned</td>
		</tr>
		<tr>
			<td>first trailing<br>
			...<br>
			last trailing</td>
			<td>p != ignore,<br>
			used for trailing syllable components</td>
			<td>Jamo Trailing<br>
			Jamo Leading</td>
		</tr>
	</table>
	<p>Each of the above Names (except <i>implicits</i>) can be used with a reset to position characters relative to that logical position. That allows characters 
	to be ordered before or after a <i>logical</i> position rather than a specific character.</p>
	<blockquote>
		<p class="note"><b>Note: </b>The reason for this is so that tailorings can be more stable. A future version of the UCA might add characters at any 
		point in the above list. Suppose that you set character X to be after Y. It could be that you want X to come after Y, no matter what future characters are 
		added; or it could be that you just want Y to come after a given logical position, 
		for example, after the last primary ignorable.</p>
	</blockquote>
	<p>Here is an example of the syntax:</p>
	<pre>&amp; [first tertiary ignorable] &lt;&lt; √† </pre>
	<p>For example, to make a character be a secondary ignorable,
	one can make it be immediately after (at a secondary level) a specific character (like a combining diaeresis),
	or one can make it be immediately after the last secondary ignorable.</p>

	<p>The <code class="changed">[last variable]</code> indicates the &quot;highest&quot; character
	that is treated as punctuation with alternate handling.
	Unlike the other logical positions, it can be reset as well as referenced.
	For example, it can be reset to be just above spaces if all visible punctuation are to be treated as having distinct 
	primary values.</p>
	<table>
		<caption class="changed">Specifying the Position of <code>[last variable]</code></caption>
		<tr>
			<th>Attribute</th>
			<th>Options</th>
			<th>Example</th>
		</tr>
		<tr>
			<td rowspan="3">variableTop</td>
			<td><font color="#000000">at</font></td>
			<td><code>&amp; x<br>
			= [<span class="changed">variable top</span>]</code></td>
		</tr>
		<tr>
			<td><font color="#000000">after</font></td>
			<td><code>&amp; x<br>
			&lt; [<span class="changed">variable top</span>]</code></td>
		</tr>
		<tr>
			<td><font color="#000000">before</font></td>
			<td><code>&amp; [before 1] x<br>
			&lt; [<span class="changed">variable top</span>]</code></td>
		</tr>
	</table>
	<p>The default value for <code class="changed">[last variable]</code> is  the highest punctuation mark, thus below symbols.
	The value can be further changed by using the variable-top setting.
	This takes effect, however, after the rules have been built,
	and does not affect any characters that are reset relative to the <code class="changed">[last variable]</code> value when the rules are being built.
	The variable-top setting might also be changed via a runtime parameter. That also does not effect the rules.</p>
<p class="removed">The <code>&lt;last_variable/&gt;</code> cannot occur inside an &lt;x&gt; element, nor can there be any element content. Thus there can be no &lt;context&gt; or &lt;extend&gt; or 
text data in the rule. For example, the following are all disallowed:</p>
	<ul class="removed">
		<li><code>&lt;x&gt;&lt;context&gt;<span style="color: blue">a</span>&lt;/context&gt;&lt;p&gt;&lt;last_variable/&gt;&lt;/p&gt;&lt;/x&gt;</code></li>
		<li><code>&lt;x&gt;&lt;p&gt;&lt;last_variable/&gt;&lt;/p&gt;&lt;extend&gt;<span style="color: blue">a</span>&lt;/extend&gt;&lt;/x&gt;</code></li>
		<li><code>&lt;p&gt;&lt;last_variable/&gt;<span style="color: blue">a</span>&lt;/p&gt;</code></li>
		<li><code>&lt;p&gt;<span style="color: blue">a</span>&lt;last_variable/&gt;&lt;/p&gt;</code>	</li>
	</ul>

	<h3><a name="Special_Purpose_Commands" href="#Special_Purpose_Commands">3.11 Special-Purpose Commands</a></h3>
	<p class="dtd">&lt;!ELEMENT import EMPTY &gt;<br>
    &lt;!ATTLIST import source CDATA #REQUIRED &gt;<br>
    &lt;!ATTLIST import type CDATA #IMPLIED &gt;</p>
	<p>The import command imports rules from another collation. This allows for better maintenance and smaller rule sizes. The source is the locale of the source, and the type is the type (if any). If the source is &quot;locale&quot; it is the same locale. The type is defaulted to &quot;standard&quot;.</p>
	<p><em>Example:</em></p>
	<pre>&lt;import source=&quot;de&quot; type=&quot;phonebook&quot;/&gt;</pre>
    <table>
      <caption>
        Special-Purpose Commands
      </caption>
      <tr>
        <th class="changed">Rule Syntax</th>
        <th class="changed">Sub-Element of <span class="element">collation</span> (preferred)</th>
      </tr>
      <tr>
        <td>[suppress contractions [–â-“ë]]</td>
        <td><code>&lt;suppress_contractions&gt;</code><span style="color: blue">[–â-“ë]</span><code>&lt;/suppress_contractions&gt;</code></td>
      </tr>
      <tr>
        <td>[optimize [ŒÜ-œé]]</td>
        <td><code>&lt;optimize&gt;</code><span style="color: blue">[ŒÜ-œé]</span><code>&lt;/optimize&gt;</code></td>
      </tr>
    </table>
<p>The <i>suppress contractions</i> tailoring command turns off any existing contractions that begin with those characters. It is typically used to turn off 
	the Cyrillic contractions in the UCA, since they are not used in many languages and have a considerable performance penalty. The argument is a
<a href="tr35.html#Unicode_Sets">Unicode Set</a>.</p>
	<p>The <i>optimize</i> tailoring command is purely for performance. It indicates that those characters are sufficiently common in the target language for the 
  tailoring that their performance should be enhanced.</p>
	<p>	  The reason that these are not settings is so that their contents can be arbitrary characters. </p>
	<hr width="50%">
  <p><i>Example:</i></p>
	<p>The following is a simple example that combines portions of different tailorings for illustration. For more 
	complete examples, see the actual locale data: <a href="http://unicode.org/repos/cldr/trunk/common/collation/ja.xml">Japanese</a>, <a href="http://unicode.org/repos/cldr/trunk/common/collation/zh.xml">Chinese</a>, <a href="http://unicode.org/repos/cldr/trunk/common/collation/sv.xml">Swedish</a>, and  <a href="http://unicode.org/repos/cldr/trunk/common/collation/de.xml">German</a> (type=&quot;phonebook&quot;) are particularly illustrative.</p>
<pre class="changed">&lt;collation&gt;
  &lt;settings caseLevel=&quot;<span style="color: blue">on</span>&quot;/&gt;
  &lt;cr&gt;&lt;![CDATA[
    &amp;Z
    &lt; √¶ &lt;&lt;&lt; √Ü
    &lt; √• &lt;&lt;&lt; √Ö &lt;&lt;&lt; aa &lt;&lt;&lt; aA &lt;&lt;&lt; Aa &lt;&lt;&lt; AA
    &lt; √§ &lt;&lt;&lt; √Ñ
    &lt; √∂ &lt;&lt;&lt; √ñ &lt;&lt; ≈± &lt;&lt;&lt; ≈∞
    &lt; ≈ë &lt;&lt;&lt; ≈ê &lt;&lt; √∏ &lt;&lt;&lt; √ò
    &amp;V &lt;&lt;&lt;* wW
    &amp;Y &lt;&lt;&lt;* √º√ú
    &amp;[last non-ignorable]
    <span style="color:green"># The following is equivalent to &lt;‰∫ú&lt;Âîñ&lt;Â®É...</span>
    &lt;* ‰∫úÂîñÂ®ÉÈòøÂìÄÊÑõÊå®Âß∂ÈÄ¢ËëµËåúÁ©êÊÇ™Êè°Ê∏•Êó≠Ëë¶Ëä¶
    &lt;* ÈØµÊ¢ìÂúßÊñ°Êâ±
  ]]&gt;&lt;/cr&gt;
&lt;/collation&gt;</pre>

	<h3><a name="Script_Reordering" href="#Script_Reordering">3.12 Collation Reordering</a></h3>
<p>Collation reordering allows scripts and certain other defined blocks of characters to be moved relative to each other parametrically, without changing the detailed rules for all the characters involved. This reordering is done on top of any specific ordering rules within the script or block currently in effect. Reordering can specify groups to be placed at the start and/or the end of the collation order. For example, to reorder Greek characters before Latin characters, and digits afterwards (but before other scripts), the following can be used:</p>
<table >
  <tr>
    <th><span class="changed">Rule</span> Syntax</th>
    <th class="changed">Sub-Element of <span class="element">collation</span> (preferred)</th>
    <th>Locale Identifier</th>
  </tr>
  <tr>
    <td><code>[reorder Grek Latn digit]</code></td>
    <td><code>&lt;settings reorder="Grek Latn digit"/&gt;</code></td>
    <td><code>en-u-kr-grek-latn-digit</code></td>
  </tr>
</table>
<p>In each case, a sequence of <em><strong>reorder_codes</strong></em> is used,
separated by spaces <span class="removed">for basic and XML syntax</span> <span class="changed">in the settings attribute and in rule syntax</span>,
and by hyphens in locale identifiers.</p>
<p>A <strong><em>reorder_code</em></strong> is any of the following special codes:</p>
<ol>
  <li><strong>space, punct, symbol, currency, digit</strong> - core groups of characters below 'a'</li>
  <li><strong>any script code</strong> from the 
  <a href="http://www.unicode.org/reports/tr31/tr31-15.html#Table_Recommended_Scripts">Recommended</a> Table in UAX 31 except <strong>Katakana</strong>, <strong>Common</strong>, and <strong>Inherited</strong>. 
    <ol>
      <li>Katakana characters are are always reordered with Hiragana.</li>
      <li>Characters in any script not in the 
	  <a href="http://www.unicode.org/reports/tr31/tr31-15.html#Table_Recommended_Scripts">Recommended</a> Table are treated as being in the preceding 
	  <a href="http://www.unicode.org/reports/tr31/tr31-15.html#Table_Recommended_Scripts">Recommended</a> script, in DUCET order. Thus Phoenician characters always reorder with Hebrew characters.</li>
    </ol>
  </li>
  <li><strong>others</strong> -  where all codes not explicitly mentioned should be ordered. The script code <strong>Zzzz</strong> (Unknown Script) is a synonym for <strong>others</strong>.</li>
</ol>
<p>It is an error if a code occurs multiple times.</p>
<h4>Interpretation of a reordering list</h4>
<p>The reordering list is interpreted as if it were processed in the following way.</p>
<ol class="c18" start="1">
  <li>If any core code is not present, then it is inserted at the front of the list in the order given above.</li>
  <li>If the <strong>others</strong> code is not present, then it is inserted at the end of the list.</li>
  <li>The <strong>others</strong> code is replaced by the list of all script codes not explicitly mentioned, in DUCET order.</li>
  <li>The reordering list is now complete, and used to reorder characters in collation accordingly.</li>
</ol>
<p>The locale data may have a particular ordering. For example, the Czech locale data could put digits after all letters, with <code>[reorder others digit]</code>.
  Any reordering codes specified on top of that (such as with a bcp47 locale identifier) completely replace what was there. To specify a version of collation that completely
  resets any existing reordering to the DUCET ordering, the single code <strong>others</strong> can be used, as below<strong></strong>.</p>
<p><em>Examples: </em></p>
<table cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <th class="c2">Locale Identifier</th>
      <th class="c2">Effect</th>
    </tr>
    <tr>
      <td class="c2"><code>en-u-kr-latn-digit</code></td>
      <td class="c2">Reorder digits after Latin characters (but before other scripts like Cyrillic).</td>
    </tr>
    <tr>
      <td class="c2"><code>en-u-kr-others-digit</code></td>
      <td class="c2">Reorder digits after all other characters.</td>
    </tr>
    <tr>
      <td class="c2"><code>en-u-kr-arab-cyrl-others-symbol</code></td>
      <td class="c2">Reorder Arabic characters first, then Cyrillic, and put symbols at the end‚Äîafter all other characters.</td>
    </tr>
    <tr>
      <td class="c2"><code>en-u-kr-others</code></td>
      <td class="c2">Remove any locale-specific reordering, and use DUCET order for reordering blocks.</td>
    </tr>
  </tbody>
</table>
<p>The default  reordering groups are defined by the FractionalUCA.txt file, based on the primary weights of associated collation elements. The [top_byte] table contains a mapping from the first (top) byte of  primary weights  to the associated reordering group. For example:</p>
<blockquote>
  <p>U+02D0 MODIFIER LETTER TRIANGULAR COLON has a fractional UCA collation weight of [<strong>0E</strong> 0B, 05, 05]. In the [top_byte] table, the line [top_byte	0E	SYMBOL] indicates that <strong>0E</strong> maps to <strong>SYMBOL</strong>.</p>
</blockquote>
<p>There are some special cases:</p>
<ul>
  <li>The TRAILING group, the FIELD-SEPARATOR (associated with U+FFFE), and collation elements with only zero primary weights are not reordered. </li>
  <li>The IMPLICIT group is currently treated as if it were part of <strong>Hani</strong>. </li>
  <li>The TERMINATOR, LEVEL-SEPARATOR,  and SPECIAL groups are never associated with characters. </li>
</ul>
<p>The default reordering groups follow the allkeys_CLDR.txt ordering; they also may be tailored by implementations to different values. For more information on FractionalUCA.txt and allkeys_CLDR.txt, see <a href="http://unicode.org/Public/UCA/latest/CollationAuxiliary.html">Collation Auxiliary</a>.</p>
<p> The DUCET ordering is slightly different from the allkeys_CLDR ordering. The reordering groups for the DUCET are not specified here. However, most reordering groups would start with the same characters as in FractionalUCA.txt.</p>
<h3><a name="Case_Parameters" href="#Case_Parameters">3.13 Case Parameters</a></h3>
<p>The <strong>case level</strong> is an <em>optional</em> intermediate level (&quot;2.5&quot;) between Level 2 and Level 3 (or after Level 1, if there is no Level 2 due to strength settings). The case level is used to support two parametric features: ignoring non-case variants (Level 3 differences) except for case, and giving case differences a higher-level priority than other tertiary differences.  Distinctions between small and large Kana characters are also included as case differences, to support Japanese collation.</p>
<p>The <strong>case first</strong> parameter controls whether to swap the order of upper and lowercase. It can be used with or without the case level. </p>
<p>Importantly, the case parameters  have no effect in many instances. For example, they have no effect on the comparison of two non-ignorable characters with different primary weights, or with different secondary weights if the strength = <strong>secondary (or higher).</strong></p>
<p>When either the <strong>case level</strong> or <strong>case first</strong> parameters are set, the following describes the derivation of the modified collation elements. It assumes the original levels for the code point are [p.s.t] (primary, secondary, tertiary). This derivation may change in future versions of LDML, to track the case characteristics  more closely.</p>
<h5><strong>Untailored Characters</strong></h5>
<p>For untailored characters and strings, that is, for mappings in the root collation,
the case value for each collation element is computed from the tertiary weight listed in allkeys_CLDR.txt.
This is used to modify the collation element.</p>
<ol>
  <li>If the character is U+FFFE (lowest-weight), set case value = LOWEST. </li>
  <li>Otherwise, look up a  case value for the tertiary weight x of each collation element:
    <ol>
      <li>UPPER if x ‚àà  {08-0C, 0E, 11, 12, 1D}</li>
      <li>UNCASED otherwise</li>
      </ol>
  </li>
</ol>
<h5><strong>Compute Modified Collation Elements</strong></h5>
<p>From a computed case value, set a weight <strong>c</strong> according to the following.</p>
<ol>
  <li>If the value is LOWEST, set <strong>c</strong> = 1</li>
  <li>Otherwise if <strong>CaseFirst=UpperFirst</strong>, set <strong>c</strong> = UPPER ? <strong>2</strong> : MIXED ? 3 : <strong>4</strong></li>
  <li>Otherwise set <strong>c</strong> = UPPER ? <strong>4</strong> : MIXED ? 3 : <strong>2</strong></li>
</ol>
<p>Compute a new collation element according to the following table. The notation <em>xt</em> means that the values are numerically combined into a single level, such that xt &lt; yu whenever x &lt; y. The fourth level (if it exists) is unaffected.</p>

  <div align="center">
    <table>
      <tbody>
        <tr>
          <th>Case Level</th>
          <th>Strength</th>
          <th>Original CE</th>
          <th>Modified CE</th>
          <th>Comment</th>
        </tr>
        <tr>
          <td rowspan="5"><strong>on</strong></td>
          <td rowspan="2"><strong>primary</strong></td>
          <td><code>0.s.t</code></td>
          <td><code>0.0</code></td>
          <td rowspan="2">ignore case level weights of primary-ignorable CEs</td>
        </tr>
        <tr>
          <td><code>p.s.t</code></td>
          <td><code>p.c</code></td>
        </tr>
        <tr>
          <td rowspan="3"><strong>secondary<br>
          </strong>or higher</td>
          <td><code>0.0.t</code></td>
          <td><code>0.0.0.t</code></td>
          <td rowspan="3">ignore case level weights of secondary-ignorable CEs</td>
        </tr>
        <tr>
          <td><code>0.s.t</code></td>
          <td><code>0.s.c.t</code></td>
        </tr>
        <tr>
          <td><code>p.s.t</code></td>
          <td><code>p.s.c.t</code></td>
        </tr>
        <tr>
          <td rowspan="4"><strong>off</strong></td>
          <td rowspan="4">any</td>
          <td><code>0.0.0</code></td>
          <td><code>0.0.00</code></td>
          <td rowspan="4">ignore case level weights of tertiary-ignorable CEs</td>
        </tr>
        <tr>
          <td><code>0.0.t</code></td>
          <td><code>0.0.4t</code></td>
        </tr>
        <tr>
          <td><code>0.s.t</code></td>
          <td><code>0.s.ct</code></td>
        </tr>
        <tr>
          <td><code>p.s.t</code></td>
          <td><code>p.s.ct</code></td>
        </tr>
      </tbody>
    </table>
  </div>






<p>Note the special case weights when s = 0. They ensure the construction of well-formed case and tertiay weights. For details, see <em>Section 3.7, Well-Formed Collation Element Tables</em> in [<a href="http://www.unicode.org/reports/tr41/#UTS10">UCA</a>].</p>
<h5>Tailored Strings</h5>
<p>Characters and strings that are tailored <span class="removed">(e.g., via LDML/XML collation syntax or basic collation syntax)</span>
have case values computed from their UCD properties.
A known limitation of the tailoring is that where the source string is a contraction of cased characters, the case level does not reflect the difference in mixed cases, such as between &quot;dZ&quot; and Dz&quot;.</p>
<ol>
  <li>Form a set of case values by looking  up a case value for each character x in the NFKD mapping of the source string, based on UCD properties:
<ol>
  <li>UNCASED if x ‚àà <a href="#UncasedExceptions">UncasedExceptions</a></li>
  <li>LOWER if x ‚àà <strong>Lowercase</strong> or x ‚àà <strong>Changes_When_Uppercased</strong> or x ‚àà <a href="#LowerExceptions">LowerExceptions</a></li>
  <li>UPPER if x ‚àà <strong>Uppercase</strong> or x ‚àà <strong>Changes_When_Lowercased</strong> or x ‚àà <a href="#UpperExceptions">UpperExceptions</a></li>
  <li>MIXED if x ‚àà <strong>gc=Lt</strong> or both (a) and (b)</li>
  <li>UNCASED otherwise</li>
  </ol>

  <li>Compute a single case value from this set, by first removing UNCASED, then setting:
    <ol>
      <li>MIXED if not all elements are identical, otherwise</li>
      <li>UPPER if the set contains UPPER, otherwise</li>
      <li>LOWER</li>
    </ol>
  </li>
  <li>Apply that case-value to the first collation element in the tailoring, according to &quot;<strong>Compute Modified Collation Elements</strong>&quot;. The case values and weights in an expansion are unaffected.</li>
</ol>
<p><strong><a name="UncasedExceptions" href="#UncasedExceptions">UncasedExceptions</a>:</strong> is  the set of letter modifiers</p>
<ul>
  <li>[:General_Category=Lm:]</li>
</ul>
<p><strong><a name="LowerExceptions" href="#LowerExceptions">LowerExceptions</a>:</strong> is  the set of small letters where script=Hiragana or Katakana, plus other characters lowercase in form. In Unicode 6.2, these are:</p>
<ul>
  <li>[„ÅÅ„Ç° „ÅÉ„Ç£ „ÅÖ„Ç• „Åá„Çß „Åâ„Ç© „Çï„Éµ „á∞ „Çñ„É∂ „á± „á≤ „Å£„ÉÉ „á≥-„á∫ „ÇÉ„É£ „ÇÖ„É• „Çá„Éß „áª-„áø „Çé„ÉÆ]</li>
  <li>[‚Ñ©]</li>
</ul>
<p><strong><a name="UpperExceptions" href="#UpperExceptions">UpperExceptions</a>:</strong> is  the set of non-small letters where script=Hiragana or Katakana, minus the iteration mark, plus other characters uppercase in form. In Unicode 6.2, these are:</p>
<ul>
  <li>[„ÅÇ„ÅÑ„ÅÜ„Åà„Åä-„Å¢„Å§-„ÇÇ„ÇÑ„ÇÜ„Çà-„Çç„Çè-„Çî„Ç¢„Ç§„Ç¶„Ç®„Ç™-„ÉÇ„ÉÑ-„É¢„É§„É¶„É®-„É≠„ÉØ-„É¥„É∑-„É∫ õÄÄõÄÅ]</li>
  <li>[‚Ñò‚Ñ∫‚ÖÅ-‚ÖÑüÖê-üÖ©üÖ∞-üÜä]</li>
</ul>
<h3><a name="Visibility" href="#Visibility">3.14 Visibility</a></h3>
<p class="dtd">&lt;!ATTLIST collation visibility ( internal | external ) &quot;external&quot; &gt;</p>
<p>Collators have external visibility by default, meaning that they can be displayed in a list of collation
options for users to choose from. Collators marked as having internal visibility should not be shown in such a list.
Collators are typically internal when they are partial sequences included in other collators.</p>

<h3><a name="Collation_Indexes" href="#Collation_Indexes">3.15 Collation Indexes</a></h3>
<h4>Index Characters</h4>
  <p>The main data includes &lt;exemplarCharacters&gt; for collation indexes.
  See the main document, <i>Section 5.6 <a href="tr35.html#Character_Elements">Character Elements</a></i>,
  for general information about exemplar characters.</p>
  <p>The index characters are a set of characters for use as a UI "index",
  that is, a list of clickable characters (or character sequences)
  that allow the user to see a segment of a larger "target" list.
  Each character corresponds to a bucket in the target list.
  One may have different kinds of index lists;
  one that produces an index list that is relatively static,
  and the other is a list that produces roughly equally-sized buckets.
  While CLDR is mostly focused on the first,
  there is provision for supporting the second as well.</p>
  <p>The index characters need to be used in conjunction with a collation for the locale,
  which will determine the order of the characters.
  It will also determine which index characters show up.</p>
  <p>The static list would be presented as something like the following (either vertically or horizontally):
  </p>
  <p align="center">‚Ä¶¬†A B C D E F G H CH I J K L M N O P Q R S T U V W X Y Z¬†‚Ä¶</p>
  <p>In the "A" bucket, you would find all items that are
  primary greater than or equal to "A" in collation order, and primary less than  "B".
  The use of the list requires that the target list be sorted according to
  the locale that is used to create that list.
  Although we say "character" above, the index character could be a sequence, like "CH" above.
  The index exemplar characters must always be used with a collation appropriate for the locale.
  Any characters that do not have primary differences from others in the set should be removed.</p>
  <p>Details:</p>
  <ol>
    <li>The primary weight (according to the collation)
    is used to determine which bucket a string is in.
    There are special buckets for before the first character,
    between buckets of different scripts,
    and after the last bucket (and of a different script).</li>
    <li>Characters in the <em>index characters</em> do not need to have distinct primary weights.
    That is, the <em>index characters</em> are adapted to the underlying collation:
    normally –Å is in the –ï bucket for Russian,
    but if someone used a variant of Russian collation that distinguished them on a primary level,
    then –Å would show up as its own bucket.</li>
    <li>If an <em>index character</em> string ends with a single "*" (U+002A),
    for example "Sch*" and "St*" in German,
    then there will be a separate bucket for the string minus the "*", for example "Sch" and "St",
    even if that string does not sort distinctly.</li>
    <li>An <em>index character</em> can have multiple primary weights,
    for example "√Ü" and "Sch".
    Names that have the same initial primary weights sort into this <em>index character</em>‚Äôs bucket.
    This can be achieved by using an upper-boundary string that is the concatenation of
    the <em>index character</em> and U+FFFF, for example "√Ü\uFFFF" and "Sch\uFFFF".
    Names that sort greater than this upper boundary but less than the next index character
    are redirected to the last preceding single-primary index character (A and S for the examples here).</li>
  </ol>
  <p>For example, for index characters <code>[A √Ü B R S {Sch*} {St*} T]</code>
  the following sample names are sorted into an index as shown.</p>
  <ul>
    <li>A &mdash; Adelbert, Afrika</li>
    <li>√Ü &mdash; √Üsculap, Aesthet</li>
    <li>B &mdash; Berlin</li>
    <li>R &mdash; Rilke</li>
    <li>S &mdash; Sacher, Seiler, Sultan</li>
    <li>Sch &mdash; Schiller</li>
    <li>St &mdash; Steiff</li>
    <li>T &mdash; Thomas</li>
  </ul>
  <p>The¬†‚Ä¶¬†items are special:
  each is a bucket for everything else, either less or greater.
  They are inserted at the start and end of the index list, <em>and</em> on script boundaries.
  These are really script boundaries, <em>not</em> reordering code boundaries.
  Each script has its own range, except where scripts sort primary-equal (e.g., Hira &amp; Kana).
  All characters that sort in the low reordering groups
  (whitespace, punctuation, symbols, currency symbols, digits)
  are treated as a single script for this purpose.
  So if you had a collation that reordered Hebrew after Ethiopic,
  you would still get index boundaries between the following (and in that order):</p>
  <ol>
    <li>Ethiopic</li>
    <li>Hebrew</li>
    <li>Phoenician<em>¬†// included in the Hebrew reordering group</em></li>
    <li>Samaritan<em>¬†// included in the Hebrew reordering group</em></li>
    <li>Devanagari</li>
  </ol>
  <p>If you tailor a Greek character into the Cyrillic script,
  that Greek character will be bucketed (and sorted) among the Cyrillic ones.</p>
  <p>In the UI, an index character could also be omitted or grayed out if its bucket is empty.
  For example, if there is nothing in the bucket for Q, then Q could be omitted.
  That would be up to the implementation.
  Additional buckets could be added if other characters are present.
  For example, we might see something like the following:</p>
  <table border="1" cellspacing="0">
    <tbody>
      <tr align="center">
        <td><div align="center"><strong>Sample Greek Index<br>
        </strong></div></td>
        <td><strong>Contents<br>
          </strong></td>
      </tr>
      <tr align="center">
        <td><div align="center">¬†Œë Œí Œì Œî Œï Œñ Œó Œò Œô Œö Œõ Œú Œù Œû Œü Œ† Œ° Œ£ Œ§ Œ• Œ¶ Œß Œ® Œ©</div></td>
        <td>With only content beginning with Greek letters¬†<br>
        </td>
      </tr>
      <tr align="center">
        <td><div align="center">¬†‚Ä¶ Œë Œí Œì Œî Œï Œñ Œó Œò Œô Œö Œõ Œú Œù Œû Œü Œ† Œ° Œ£ Œ§ Œ• Œ¶ Œß Œ® Œ© ‚Ä¶</div></td>
        <td>With some content before or after</td>
      </tr>
      <tr align="center">
        <td><div align="center">¬†‚Ä¶ 9 Œë Œí Œì Œî Œï Œñ Œó Œò Œô Œö Œõ Œú Œù Œû Œü Œ† Œ° Œ£ Œ§ Œ• Œ¶ Œß Œ® Œ© ‚Ä¶</div></td>
        <td>With numbers, and nothing between 9 and Alpha</td>
      </tr>
      <tr align="center">
        <td><div align="center">¬† ‚Ä¶ 9¬†<em>A-Z</em>¬†Œë Œí Œì Œî Œï Œñ Œó Œò Œô Œö Œõ Œú Œù Œû Œü Œ† Œ° Œ£ Œ§ Œ• Œ¶ Œß Œ® Œ© ‚Ä¶</div></td>
        <td>With numbers, some Latin</td>
      </tr>
    </tbody>
  </table>
  <p>Here is a sample of the XML structure:</p>
  <pre>&lt;exemplarCharacters type=&quot;index&quot;&gt;[A B C D E F G H I J K L M N O P Q R S T U V W X Y Z]&lt;/exemplarCharacters&gt;</pre>
  <p>The display of the index characters can be modified with the Index labels elements,
  discussed in the main document, <i>Section 5.6.4 <a href="tr35.html#IndexLabels">Index Labels</a></i>.</p>

<h4>CJK Index Markers</h4>
  <p>Special index markers have been added to the CJK collations for stroke, pinyin, zhuyin, and unihan.
  These markers allow for effective and robust use of indexes for these collations.
  For example, near the start of the pinyin tailoring there is the following:</p>
  <p>&lt;p&gt; A&lt;/p&gt;&lt;!-- INDEX A --&gt;<br>
    &lt;pc&gt;ÈòøÂëµ••©Èîï†ºû®âö&lt;/pc&gt;&lt;!-- ƒÅ --&gt;</p>
  <p>‚Ä¶</p>
  <p>&lt;pc&gt;Áø∂&lt;/pc&gt;&lt;!-- ao --&gt;<br>
    &lt;p&gt; B&lt;/p&gt;&lt;!-- INDEX B --&gt;</p>
  <p>These indicate the boundaries of &quot;buckets&quot; that can be used for indexing.
  They are always two characters starting with the noncharacter U+FDD0,
  and thus will not occur in normal text.
  For pinyin the second character is A-Z;
  for unihan it is one of the radicals;
  and for stroke it is a character after U+2800 indicating the number of strokes, such as  ‚†Å.
  For zhuyin the second character is one of the standard Bopomofo characters
  in the range U+3105 through U+3129.</p>

  <p>The corresponding bucket label strings are the boundary strings
  with the leading U+FDD0 removed.
  For example, the Pinyin boundary string "\uFDD0A" yields the label string "A".</p>

  <p>However, for stroke order,
  the label string is the stroke count (second character minus U+2800)
  as a decimal-digit number followed by &#x5283; (U+5283).
  For example, the stroke order boundary string "\uFDD0\u2805" yields the label string "5&#x5283;".</p>

<hr>
	<p class="copyright">Copyright ¬© 2001-2013 Unicode, Inc. All Rights Reserved. The Unicode Consortium makes no expressed or implied warranty of any kind, and 
	assumes no liability for errors or omissions. No liability is assumed for incidental and consequential damages in connection with or arising out of the use 
	of the information or programs contained or accompanying this technical report. The Unicode <a href="http://unicode.org/copyright.html">Terms of Use</a> apply.</p>
	<p class="copyright">Unicode and the Unicode logo are trademarks of Unicode, Inc., and are registered in some jurisdictions. </p>
</div>

</body>

</html>
